<!DOCTYPE html>
<html lang="zh-cn" data-theme="light"><head>
    <meta name="google-site-verification" content="kw1N-Xm6qEr1c9PGuRd0U_T6DXkw_EHsLyz5LpuDDv8" />
    <meta name="msvalidate.01" content="EE98205D30806C22C519683EFC53E9BA" />
    <meta name="baidu-site-verification" content="iPC3wUcQLL" />
    <title>  vue æ•°æ®åŠ«æŒè¯¦è§£ </title>
    <meta charset="utf-8" /><meta name="generator" content="Hugo 0.74.3" /><meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1" />
    <meta name="description" itemprop="description"
        content=" vue æ•°æ®åŠ«æŒè¯¦è§£ " />
    <meta name="keywords" itemprop="keywords"
        content=" [vue æ•°æ®åŠ«æŒ] " />
    <base href="https://tomtomyoung.top/">
    <link rel="shortcut icon" href="https://tomtomyoung.top/favicons//favicon.ico" type="image/x-icon">
    <link rel="icon" type="image/png" sizes="32x32" href="https://tomtomyoung.top/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://tomtomyoung.top/favicons/favicon-16x16.png">
    <link rel="canonical" href="https://tomtomyoung.top/post/vue-%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81%E8%AF%A6%E8%A7%A3/">
    <link rel="stylesheet" type="text/css" href="https://at.alicdn.com/t/font_2450869_iypnqhtzjei.css">
    
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="https://tomtomyoung.top/css/style.min.055753282b6ac09fa55cab335d0b741082b8d559a711f8f22b98b98ac3dd1bb2.css" integrity="" type="text/css">
    
    
    <script type="text/javascript" src="https://tomtomyoung.top/js/docsearch.min.69f8ad33daa0ba1950834aaf16111d935f6a7e2b03db2cc2ae537724142b2719782bcea9aba5996af27f6f94a8365b6575ce2eff90506c2bba9aa0411587116c.js" integrity=""></script>
</head><body class="animated fadeInDown">
<div class="main"><div class="percentage_container">
    <div class="percentage" id="percentage"></div>
</div><div class="toc sub-container">
    <div class="toc-header">
        <span>ç›®å½•</span>
    </div><ul class="toc-h2"><li>
                <span class="toc-link">1. æ•°æ®åŠ«æŒåŸç†</span>
            </li>
            <li>
                <span class="toc-link">2. å®ç°æ•°æ®åŠ«æŒ</span>
            </li>
            
                    <ul class="toc-h3"><li>
                <span class="toc-link">1. Vue(MVVM)</span>
            </li>
            
                    <ul class="toc-h4"><li>
                <span class="toc-link">1. å®šä¹‰ Vue æ„é€ å‡½æ•°</span>
            </li>
            <li>
                <span class="toc-link">2. Vue åˆå§‹åŒ–</span>
            </li>
            
                    </ul><li>
                <span class="toc-link">2. Observer</span>
            </li>
            
                    <ul class="toc-h4"><li>
                <span class="toc-link">1. å¤„ç†å¯¹è±¡</span>
            </li>
            
                    <ul class="toc-h5"><li>
                <span class="toc-link">1. ç›‘å¬å¯¹è±¡</span>
            </li>
            <li>
                <span class="toc-link">2. ç›‘å¬è®¾ç½®çš„æ–°æ•°å€¼</span>
            </li>
            
                    </ul><li>
                <span class="toc-link">2. å¤„ç†æ•°ç»„</span>
            </li>
            
                    <ul class="toc-h5"><li>
                <span class="toc-link">1. åˆ¤æ–­æ•°ç»„</span>
            </li>
            <li>
                <span class="toc-link">2. é‡å†™æ•°ç»„æ–¹æ³•</span>
            </li>
            <li>
                <span class="toc-link">3. ç›‘å¬æ•°ç»„</span>
            </li>
            <li>
                <span class="toc-link">4. ç›‘å¬æ•°ç»„æ–°å…ƒç´ </span>
            </li>
            
                    </ul>
                    </ul>
                    </ul><li>
                <span class="toc-link">3. Vueæºç </span>
            </li>
            </div><div class="single-post container">
    <div class="post">
      <div class="header">
        <span class="title">vue æ•°æ®åŠ«æŒè¯¦è§£</span>
        
        <div class="info">
          <span>ğŸ“… 2021-09-03</span>
          <span>ğŸ‘¦ Tomtom Young</span>
          <span>ğŸ“– 2802å­—</span>
          <span>â± 6åˆ†é’Ÿ</span>
        </div>
        
      </div>
      <div class="content markdown-body">
        <blockquote>
<p>å‚è€ƒï¼š</p>
<p><a href="https://cn.vuejs.org/v2/guide/reactivity.html#%E5%A6%82%E4%BD%95%E8%BF%BD%E8%B8%AA%E5%8F%98%E5%8C%96">Vue.js_æ·±å…¥å“åº”å¼åŸç†</a></p>
<p><a href="https://www.cnblogs.com/demonxian3/p/13546525.html">Vueæºç åˆ†æä¹‹å®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆçš„Vue</a></p>
<p><a href="https://github.com/DMQ/mvvm">DMQ/mvvm</a></p>
</blockquote>
<h2 id="1-æ•°æ®åŠ«æŒåŸç†">1. æ•°æ®åŠ«æŒåŸç†</h2>
<p>å…³äºå¦‚ä½•å®ç°æ•°æ®åŠ«æŒï¼Œåœ¨Vueçš„å®˜ç½‘æœ‰ä¸€æ®µæè¿°ï¼š</p>
<blockquote>
<p>Vue æœ€ç‹¬ç‰¹çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œæ˜¯å…¶éä¾µå…¥æ€§çš„å“åº”å¼ç³»ç»Ÿã€‚æ•°æ®æ¨¡å‹ä»…ä»…æ˜¯æ™®é€šçš„ JavaScript å¯¹è±¡ã€‚è€Œå½“ä½ ä¿®æ”¹å®ƒä»¬æ—¶ï¼Œè§†å›¾ä¼šè¿›è¡Œæ›´æ–°ã€‚</p>
<p>è¿™ä½¿å¾—çŠ¶æ€ç®¡ç†éå¸¸ç®€å•ç›´æ¥ï¼Œä¸è¿‡ç†è§£å…¶å·¥ä½œåŸç†åŒæ ·é‡è¦ï¼Œè¿™æ ·ä½ å¯ä»¥é¿å¼€ä¸€äº›å¸¸è§çš„é—®é¢˜ã€‚</p>
<p><strong>å¦‚ä½•è¿½è¸ªå˜åŒ–</strong></p>
<p>å½“ä½ æŠŠä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ä¼ å…¥ Vue å®ä¾‹ä½œä¸º <code>data</code> é€‰é¡¹ï¼ŒVue å°†éå†æ­¤å¯¹è±¡æ‰€æœ‰çš„ <code>property</code>ï¼Œå¹¶ä½¿ç”¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty"><code>Object.defineProperty</code></a> æŠŠè¿™äº› <code>property</code> å…¨éƒ¨è½¬ä¸º <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Working_with_Objects#%E5%AE%9A%E4%B9%89_getters_%E4%B8%8E_setters"><code>getter/setter</code></a>ã€‚</p>
<p><code>Object.defineProperty</code> æ˜¯ ES5 ä¸­ä¸€ä¸ªæ— æ³• shim çš„ç‰¹æ€§ï¼Œè¿™ä¹Ÿå°±æ˜¯ Vue ä¸æ”¯æŒ IE8 ä»¥åŠæ›´ä½ç‰ˆæœ¬æµè§ˆå™¨çš„åŸå› ã€‚</p>
<p>è¿™äº› <code>getter/setter</code> å¯¹ç”¨æˆ·æ¥è¯´æ˜¯ä¸å¯è§çš„ï¼Œä½†æ˜¯åœ¨å†…éƒ¨å®ƒä»¬è®© Vue èƒ½å¤Ÿè¿½è¸ªä¾èµ–ï¼Œåœ¨ property è¢«è®¿é—®å’Œä¿®æ”¹æ—¶é€šçŸ¥å˜æ›´ã€‚</p>
<p>æ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½å¯¹åº”ä¸€ä¸ª watcher å®ä¾‹ï¼Œå®ƒä¼šåœ¨ç»„ä»¶æ¸²æŸ“çš„è¿‡ç¨‹ä¸­æŠŠâ€œæ¥è§¦â€è¿‡çš„æ•°æ® property è®°å½•ä¸ºä¾èµ–ã€‚ä¹‹åå½“ä¾èµ–é¡¹çš„ <code>setter </code>è§¦å‘æ—¶ï¼Œä¼šé€šçŸ¥ watcherï¼Œä»è€Œä½¿å®ƒå…³è”çš„ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/data.png" alt="data"></p>
</blockquote>
<p><strong>å­˜åœ¨çš„é—®é¢˜</strong></p>
<p>æˆ‘ä»¬å¯¹æ‰€æœ‰çš„<code>property</code>çš„æ”¹å˜éƒ½å¯ä»¥è¿›è¡Œç›‘å¬ï¼Œä½†æ˜¯è¿™é‡Œä¼šæœ‰2ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>å¦‚æœä¸€ä¸ª<code>property</code>ä¸æ˜¯ä¸€ä¸ªåŸå§‹å˜é‡ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œç›‘å¬äº†ï¼Œéœ€è¦é€’å½’çš„ç›‘å¬ä¸‹ä¸€å±‚ï¼›</li>
<li>å¦‚æœä¸€ä¸ª<code>property</code>ä¸æ˜¯ä¸€ä¸ªåŸå§‹å˜é‡ï¼Œè€Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œç›‘å¬äº†ï¼›</li>
</ol>
<p>å½“ç„¶è¿™äº›é—®é¢˜åœ¨Vue3ä¸­ä¸å­˜åœ¨äº†ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥å®ç°ä¸€ä¸‹æ•°æ®åŠ«æŒã€‚</p>
<h2 id="2-å®ç°æ•°æ®åŠ«æŒ">2. å®ç°æ•°æ®åŠ«æŒ</h2>
<h3 id="1-vuemvvm">1. Vue(MVVM)</h3>
<p>Vueæ˜¯å…¥å£ï¼Œæ‰€æœ‰Vueçš„åŠŸèƒ½éƒ½æ˜¯é€šè¿‡è¿™ä¸ªå‡½æ•°æ¥æä¾›çš„ã€‚</p>
<h4 id="1-å®šä¹‰-vue-æ„é€ å‡½æ•°">1. å®šä¹‰ Vue æ„é€ å‡½æ•°</h4>
<p>æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªVueï¼Œé¦–å…ˆå°±è¦æ˜ç¡®ï¼ŒVueåœ¨ç¼–ç¨‹çš„è§’åº¦æ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªä»€ä¹ˆï¼Ÿ</p>
<p>æˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨<code>index.js</code>ä¸­ï¼Œå†™è¿™ä¹ˆä¸€æ®µä»£ç ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#ff79c6">new</span> Vue({
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  el<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;#app&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>  router,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>  store,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>  render<span style="color:#ff79c6">:</span> h =&gt; h(App)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>})
</code></pre></div><p>æˆ–è€…è¿™æ ·ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">new</span> Vue({
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    el<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;#app&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    data()<span style="color:#ff79c6">:</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    	<span style="color:#ff79c6">return</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    		name<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;å°æ˜&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    		age<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">18</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    		classMates<span style="color:#ff79c6">:</span> [
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    			{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    				name<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;å°åˆš&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    				age<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">16</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>				},
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>        		{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    				name<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;å°èŠ³&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    				age<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">16</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>				}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>    		],
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>        	pat<span style="color:#ff79c6">:</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>        		name<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;dog&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>        		age<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>        	}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>		}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>	}	
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>})
</code></pre></div><p>æ‰€ä»¥Vueæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå› ä¸ºè¿™é‡Œæˆ‘ä»¬ä¸»è¦ç ”ç©¶æ•°æ®çš„åŒå‘ç»‘å®šï¼Œæ‰€ä»¥æˆ‘ä»¬åŒ–ç¹ä¸ºç®€ï¼Œç ”ç©¶å…¶ä¸­çš„<code>el</code>å’Œ<code>data</code>å³å¯ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥å®ç°è‡ªå·±Vueï¼š</p>
<p><code>myVue.js</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">function</span> Vue (options) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> Vue;
</code></pre></div><h4 id="2-vue-åˆå§‹åŒ–">2. Vue åˆå§‹åŒ–</h4>
<p><code>myVue.js</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">function</span> Vue (options) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    <span style="color:#ff79c6">this</span>._init(options);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>Vue.prototype._init <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (options) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#8be9fd;font-style:italic">var</span> vm <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    vm.$options <span style="color:#ff79c6">=</span> options;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    <span style="color:#6272a4">// ä½¿ç”¨dataè¿›è¡Œstateçš„åˆå§‹åŒ–
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">if</span>(<span style="color:#ff79c6">!!</span>vm.$options.data){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        <span style="color:#6272a4">// åœ¨å®ä¾‹ä¸Šå­˜å‚¨ä¸€ä¸‹data
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">// dataæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4"></span>        vm.$data <span style="color:#ff79c6">=</span> 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>            <span style="color:#ff79c6">typeof</span> vm.$options.data <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;function&#39;</span> <span style="color:#ff79c6">?</span> 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>            	vm.$options.data.call(vm) 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        		<span style="color:#ff79c6">:</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>        		vm.$options.data;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>        
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>        <span style="color:#6272a4">// ä»£ç†ä¸€ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨this.XXXè®¿é—®data
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd;font-style:italic">let</span> key <span style="color:#ff79c6">in</span> vm._data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>            <span style="color:#8be9fd;font-style:italic">Object</span>.defineProperty(vm, key, {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>                get () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>                    <span style="color:#ff79c6">return</span> vm.$data[key];
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>                },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>                set (newValue) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>                    vm.$data[key] <span style="color:#ff79c6">=</span> newValue;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>                }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>            })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> Vue;
</code></pre></div><h3 id="2-observer">2. Observer</h3>
<p><code>Observer.js</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">function</span> Observer (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> Observer;
</code></pre></div><h4 id="1-å¤„ç†å¯¹è±¡">1. å¤„ç†å¯¹è±¡</h4>
<p>ä½¿ç”¨çš„æ˜¯<code>Object.defineProperty</code>ï¼Œè¿™ä¸ªæ–¹æ³•åªæœ‰å¯¹è±¡æ‰æœ‰ï¼Œå¦‚æœä¸æ˜¯å¯¹è±¡æ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä½¿ç”¨äº†ã€‚</p>
<p><code>Observer.js</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">function</span> Observer (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    <span style="color:#ff79c6">this</span>.walk(data);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>Observer.prototype.walk <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#8be9fd;font-style:italic">Object</span>.keys(data).forEach(key =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#ff79c6">this</span>.defineReactive(data, key, data[key]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>Observer.prototype.defineReactive <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (obj, key, val) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    <span style="color:#ff79c6">if</span>(<span style="color:#ff79c6">typeof</span> val <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;object&#39;</span>){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>        <span style="color:#6272a4">// é€’å½’ç›‘å¬ï¼Œå¦‚æœæŸä¸€é¡¹ä¹Ÿæ˜¯å¯¹è±¡ï¼Œé‚£å°±ç›‘å¬è¿™ä¸ªå¯¹è±¡
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.walk(val);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>    } <span style="color:#ff79c6">else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        <span style="color:#8be9fd;font-style:italic">Object</span>.defineProperty(obj, key, {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>            get () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>                <span style="color:#6272a4">// æ³¨æ„ï¼šè¿™é‡Œvalä¸å¯æ”¹æˆobj[key]ï¼Œä¼šæ— é™é€’å½’ç›´è‡³å †æ ˆæº¢å‡º
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">return</span> val;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>            },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>            set (newValue) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>                <span style="color:#ff79c6">if</span>(val <span style="color:#ff79c6">==</span> newValue){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>                    <span style="color:#ff79c6">return</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>                } <span style="color:#ff79c6">else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>                    val <span style="color:#ff79c6">=</span> newValue;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>                }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>        })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> Observer;
</code></pre></div><h5 id="1-ç›‘å¬å¯¹è±¡">1. ç›‘å¬å¯¹è±¡</h5>
<p><code>myVue.js</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">import</span> Observer form <span style="color:#f1fa8c">&#39;./Observer&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#8be9fd;font-style:italic">function</span> Vue (options) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    <span style="color:#ff79c6">this</span>._init(options);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>Vue.prototype._init <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (options) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#8be9fd;font-style:italic">var</span> vm <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    vm.$options <span style="color:#ff79c6">=</span> options;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    <span style="color:#6272a4">// ä½¿ç”¨dataè¿›è¡Œstateçš„åˆå§‹åŒ–
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">if</span>(<span style="color:#ff79c6">!!</span>vm.$options.data){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>        <span style="color:#6272a4">// åœ¨å®ä¾‹ä¸Šå­˜å‚¨ä¸€ä¸‹data
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">// dataæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4"></span>        vm.$data <span style="color:#ff79c6">=</span> 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>            <span style="color:#ff79c6">typeof</span> vm.$options.data <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;function&#39;</span> <span style="color:#ff79c6">?</span> 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>            	vm.$options.data.call(vm) 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>        		<span style="color:#ff79c6">:</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>        		vm.$options.data;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>        
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>        <span style="color:#6272a4">// ä»£ç†ä¸€ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨this.XXXè®¿é—®data
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd;font-style:italic">let</span> key <span style="color:#ff79c6">in</span> vm.$data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>            <span style="color:#8be9fd;font-style:italic">Object</span>.defineProperty(vm, key, {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>                get () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>                    <span style="color:#ff79c6">return</span> vm.$data[key];
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>                },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>                set (newValue) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>                    vm.$data[key] <span style="color:#ff79c6">=</span> newValue;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>                }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>            })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>        
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>        <span style="color:#6272a4">// å®ä¾‹åŒ–ä¸€ä¸ªç›‘å¬è€…ï¼Œç›‘å¬dataçš„å˜åŒ–
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">new</span> Observer(vm.$data);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> Vue;
</code></pre></div><h5 id="2-ç›‘å¬è®¾ç½®çš„æ–°æ•°å€¼">2. ç›‘å¬è®¾ç½®çš„æ–°æ•°å€¼</h5>
<p><code>Observer.js</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">function</span> Observer (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    <span style="color:#ff79c6">this</span>.walk(data);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>Observer.prototype.walk <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#8be9fd;font-style:italic">Object</span>.keys(data).forEach(key =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#ff79c6">this</span>.defineReactive(data, key, data[key]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>Observer.prototype.defineReactive <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (obj, key, val) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    <span style="color:#ff79c6">if</span>(<span style="color:#ff79c6">typeof</span> val <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;object&#39;</span>){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>        <span style="color:#6272a4">// é€’å½’ç›‘å¬ï¼Œå¦‚æœæŸä¸€é¡¹ä¹Ÿæ˜¯å¯¹è±¡ï¼Œé‚£å°±ç›‘å¬è¿™ä¸ªå¯¹è±¡
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.walk(val);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>    } <span style="color:#ff79c6">else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        <span style="color:#8be9fd;font-style:italic">Object</span>.defineProperty(obj, key, {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>            get () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>                <span style="color:#6272a4">// æ³¨æ„ï¼šè¿™é‡Œvalä¸å¯æ”¹æˆobj[key]ï¼Œä¼šæ— é™é€’å½’ç›´è‡³å †æ ˆæº¢å‡º
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">return</span> val;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>            },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>            set (newValue) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>                <span style="color:#ff79c6">if</span>(val <span style="color:#ff79c6">==</span> newValue){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>                    <span style="color:#ff79c6">return</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>                } <span style="color:#ff79c6">else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>                    <span style="color:#ff79c6">new</span> Observer(newValue);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>                    val <span style="color:#ff79c6">=</span> newValue;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>                }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>        })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> Observer;
</code></pre></div><h4 id="2-å¤„ç†æ•°ç»„">2. å¤„ç†æ•°ç»„</h4>
<h5 id="1-åˆ¤æ–­æ•°ç»„">1. åˆ¤æ–­æ•°ç»„</h5>
<p><code>Observer.js</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">function</span> Observer (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    <span style="color:#ff79c6">this</span>.observe(data);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>Observer.prototype.observe <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#ff79c6">if</span>(data <span style="color:#ff79c6">instanceof</span> <span style="color:#8be9fd;font-style:italic">Array</span>){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    } elseif (<span style="color:#ff79c6">typeof</span> data <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;object&#39;</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>        <span style="color:#ff79c6">this</span>.walk(data);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>Observer.prototype.walk <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    <span style="color:#8be9fd;font-style:italic">Object</span>.keys(data).forEach(key =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>        <span style="color:#ff79c6">this</span>.defineReactive(data, key, data[key]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>    })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>Observer.prototype.defineReactive <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (obj, key, val) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>    <span style="color:#ff79c6">if</span>(val <span style="color:#ff79c6">instanceof</span> <span style="color:#8be9fd;font-style:italic">Array</span> <span style="color:#ff79c6">||</span> <span style="color:#ff79c6">typeof</span> val <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;object&#39;</span>){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>        <span style="color:#6272a4">// é€’å½’ç›‘å¬ï¼Œå¦‚æœæŸä¸€é¡¹ä¹Ÿæ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œé‚£å°±è¿›å…¥ç›‘å¬å®ƒ
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.observe(val);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>    } <span style="color:#ff79c6">else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>        <span style="color:#8be9fd;font-style:italic">Object</span>.defineProperty(obj, key, {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>            get () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>                <span style="color:#6272a4">// æ³¨æ„ï¼šè¿™é‡Œvalä¸å¯æ”¹æˆobj[key]ï¼Œä¼šæ— é™é€’å½’ç›´è‡³å †æ ˆæº¢å‡º
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">return</span> val;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>            },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>            set (newValue) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>                <span style="color:#ff79c6">if</span>(val <span style="color:#ff79c6">==</span> newValue){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>                    <span style="color:#ff79c6">return</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>                } <span style="color:#ff79c6">else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>                    val <span style="color:#ff79c6">=</span> newValue;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>                }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>        })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> Observer;
</code></pre></div><h5 id="2-é‡å†™æ•°ç»„æ–¹æ³•">2. é‡å†™æ•°ç»„æ–¹æ³•</h5>
<p>ç›‘å¬æ•°ç»„å°±ä¸èƒ½ç”¨<code> Object.defineProperty</code>äº†ï¼Œè€Œæ˜¯éœ€è¦é‡å†™æ‰€æœ‰ä¼šæ”¹å˜åŸæ•°ç»„çš„æ–¹æ³•ã€‚</p>
<p>é¦–å…ˆæ¥å›å¿†ä¸€ä¸‹ï¼Œå¯ä»¥æ›´æ”¹åŸæ•°ç»„çš„æ–¹æ³•éƒ½æœ‰å“ªäº›ï¼Ÿ</p>
<ol>
<li><code>push</code>å’Œ<code>pop</code></li>
<li><code>shift</code>å’Œ<code>unshift</code></li>
<li><code>splice</code></li>
<li><code>sort</code></li>
</ol>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦é‡å†™è¿™äº›æ–¹æ³•ï¼Œåœ¨è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼ŒåŠ å…¥æˆ‘ä»¬éœ€è¦çš„æ“ä½œã€‚</p>
<p><code>Array.js</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">// å¤åˆ¶ä¸€ä»½ArrayåŸå‹ï¼Œé˜²æ­¢æ±¡æŸ“ArrayåŸå‹çš„æ–¹æ³•
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">const</span> arrayProto <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">Array</span>.prototype;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#6272a4">// ä»¥ArrayåŸå‹ä¸ºåŸå‹ï¼Œåˆå§‹åŒ–ä¸€ä¸ªä¸€ä¸ªå¯¹è±¡ï¼Œæ–°å¯¹è±¡çš„__proto__ä¼šæŒ‡å‘Array.prototype
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#6272a4"></span><span style="color:#ff79c6">const</span> array <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">Object</span>.create(arrayProto);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4">// åªéœ€è¦é‡å†™æ”¹å˜åŸæ•°ç»„çš„æ–¹æ³•ï¼Œä¸æ”¹å˜çš„å°±ä¸éœ€è¦é‡å†™
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4"></span>[<span style="color:#f1fa8c">&#39;push&#39;</span>, <span style="color:#f1fa8c">&#39;pop&#39;</span>, <span style="color:#f1fa8c">&#39;shift&#39;</span>, <span style="color:#f1fa8c">&#39;unshift&#39;</span>, <span style="color:#f1fa8c">&#39;splice&#39;</span>, <span style="color:#f1fa8c">&#39;sort&#39;</span>, <span style="color:#f1fa8c">&#39;reverse&#39;</span>].forEach(funcName =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#6272a4">// å‘æˆ‘ä»¬æ–°å»ºçš„arrayå¯¹è±¡ä¸Šæ·»åŠ è¿™äº›æ–¹æ³•
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#6272a4"></span>    array[funcName] <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (arguments) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        <span style="color:#8be9fd;font-style:italic">let</span> args <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">Array</span>.from(arguments);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        arrayProto[funcName].apply(<span style="color:#ff79c6">this</span>, args);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> array;
</code></pre></div><h5 id="3-ç›‘å¬æ•°ç»„">3. ç›‘å¬æ•°ç»„</h5>
<p>å¦‚æœæ˜¯æ•°ç»„çš„è¯ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯è¦å»ç›‘å¬æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ï¼š</p>
<p><code>Observer.js</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">import</span> customArray form <span style="color:#f1fa8c">&#39;./Array&#39;</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#8be9fd;font-style:italic">function</span> Observer (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    <span style="color:#ff79c6">this</span>.observe(data);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>Observer.prototype.observe <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#6272a4">// å¦‚æœæ˜¯æ•°ç»„ï¼Œè§‚å¯Ÿæ¯ä¸€é¡¹
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">if</span>(data <span style="color:#ff79c6">instanceof</span> <span style="color:#8be9fd;font-style:italic">Array</span>){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        <span style="color:#ff79c6">this</span>.arrayWalk(data);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    } elseif (<span style="color:#ff79c6">typeof</span> data <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;object&#39;</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>        <span style="color:#ff79c6">this</span>.walk(data);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>Observer.prototype.walk <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    <span style="color:#8be9fd;font-style:italic">Object</span>.keys(data).forEach(key =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>        <span style="color:#ff79c6">this</span>.defineReactive(data, key, data[key]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>    })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>Observer.prototype.defineReactive <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (obj, key, val) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>    <span style="color:#ff79c6">if</span>(val <span style="color:#ff79c6">instanceof</span> <span style="color:#8be9fd;font-style:italic">Array</span> <span style="color:#ff79c6">||</span> <span style="color:#ff79c6">typeof</span> val <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;object&#39;</span>){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>        <span style="color:#6272a4">// é€’å½’ç›‘å¬ï¼Œå¦‚æœæŸä¸€é¡¹ä¹Ÿæ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œé‚£å°±è¿›å…¥ç›‘å¬å®ƒ
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.observe(val);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>    } <span style="color:#ff79c6">else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>        <span style="color:#8be9fd;font-style:italic">Object</span>.defineProperty(obj, key, {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>            get () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>                <span style="color:#6272a4">// æ³¨æ„ï¼šè¿™é‡Œvalä¸å¯æ”¹æˆobj[key]ï¼Œä¼šæ— é™é€’å½’ç›´è‡³å †æ ˆæº¢å‡º
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">return</span> val;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>            },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>            set (newValue) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>                <span style="color:#ff79c6">if</span>(val <span style="color:#ff79c6">==</span> newValue){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>                    <span style="color:#ff79c6">return</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>                } <span style="color:#ff79c6">else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>                    val <span style="color:#ff79c6">=</span> newValue;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span>                }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span>            }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span>        })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span>Observer.prototype.arrayWalk <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> (data) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span>    <span style="color:#6272a4">// å®ç°æ•°ç»„æ–¹æ³•çš„ä¿®æ”¹
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span style="color:#6272a4"></span>    data.__proto__ <span style="color:#ff79c6">=</span> customArray;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span>    data.forEach(item =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span>        <span style="color:#ff79c6">this</span>.observe(item);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span>    })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> Observer;
</code></pre></div><h5 id="4-ç›‘å¬æ•°ç»„æ–°å…ƒç´ ">4. ç›‘å¬æ•°ç»„æ–°å…ƒç´ </h5>
<p>è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯ï¼Œæ•°ç»„æ–°å¢äº†å…ƒç´ ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å¯¹è¿™äº›æ–°å¢çš„å…ƒç´ æ·»åŠ ç›‘å¬ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦ç›‘å¬æ–°å…ƒç´ ï¼š</p>
<p><code>Array.js</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">import</span> Observer from <span style="color:#f1fa8c">&#39;./Observer&#39;</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#6272a4">// å¤åˆ¶ä¸€ä»½ArrayåŸå‹ï¼Œé˜²æ­¢æ±¡æŸ“ArrayåŸå‹çš„æ–¹æ³•
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#6272a4"></span><span style="color:#ff79c6">const</span> arrayProto <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">Array</span>.prototype;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4">// ä»¥ArrayåŸå‹ä¸ºåŸå‹ï¼Œåˆå§‹åŒ–ä¸€ä¸ªä¸€ä¸ªå¯¹è±¡ï¼Œæ–°å¯¹è±¡çš„__proto__ä¼šæŒ‡å‘Array.prototype
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4"></span><span style="color:#ff79c6">const</span> array <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">Object</span>.create(arrayProto);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#6272a4">// åªéœ€è¦é‡å†™æ”¹å˜åŸæ•°ç»„çš„æ–¹æ³•ï¼Œä¸æ”¹å˜çš„å°±ä¸éœ€è¦é‡å†™
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#6272a4"></span>[<span style="color:#f1fa8c">&#39;push&#39;</span>, <span style="color:#f1fa8c">&#39;pop&#39;</span>, <span style="color:#f1fa8c">&#39;shift&#39;</span>, <span style="color:#f1fa8c">&#39;unshift&#39;</span>, <span style="color:#f1fa8c">&#39;splice&#39;</span>, <span style="color:#f1fa8c">&#39;sort&#39;</span>].forEach(funcName =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    <span style="color:#6272a4">// å‘æˆ‘ä»¬æ–°å»ºçš„arrayå¯¹è±¡ä¸Šæ·»åŠ è¿™äº›æ–¹æ³•
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4"></span>    array[funcName] <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">function</span> () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>        <span style="color:#8be9fd;font-style:italic">let</span> args <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">Array</span>.from(arguments);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>        arrayProto[funcName].apply(<span style="color:#ff79c6">this</span>, args);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>        <span style="color:#6272a4">// ç›‘å¬
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">// ä¼šæ–°å¢æ•°ç»„é¡¹çš„æ–¹æ³•åªæœ‰ä¸‹é¢ä¸‰ç§
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4"></span>        <span style="color:#8be9fd;font-style:italic">let</span> newItemArr;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>        <span style="color:#ff79c6">switch</span> (funcName) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>            <span style="color:#ff79c6">case</span> <span style="color:#f1fa8c">&#39;push&#39;</span><span style="color:#ff79c6">:</span> 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>            <span style="color:#ff79c6">case</span> <span style="color:#f1fa8c">&#39;unshift&#39;</span><span style="color:#ff79c6">:</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>                newItemArr <span style="color:#ff79c6">=</span> args;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>                <span style="color:#ff79c6">break</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>            <span style="color:#ff79c6">case</span> <span style="color:#f1fa8c">&#39;splice&#39;</span><span style="color:#ff79c6">:</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>                <span style="color:#6272a4">// å› ä¸ºspliceæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‹¿ç¬¬ä¸‰é¡¹
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#6272a4"></span>                newItemArr <span style="color:#ff79c6">=</span> args.slice(<span style="color:#bd93f9">2</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>                <span style="color:#ff79c6">break</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>            <span style="color:#ff79c6">default</span><span style="color:#ff79c6">:</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>                <span style="color:#ff79c6">break</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>        <span style="color:#ff79c6">if</span>(<span style="color:#ff79c6">!!</span>newItemArr){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>            <span style="color:#ff79c6">new</span> Observer(newItemArr);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>        }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span style="color:#ff79c6">export</span> <span style="color:#ff79c6">default</span> array;
</code></pre></div><h2 id="3-vueæºç ">3. Vueæºç </h2>
<blockquote>
<p><a href="https://github.com/vuejs/vue/blob/v2.5.13/src/core/observer/index.js#L40-L54">Vue_Observer</a></p>
</blockquote>

      </div>
      <div class="footer">
        <span><a class="category" href="https://tomtomyoung.top/categories/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a><a class="category" href="https://tomtomyoung.top/categories/%E7%B2%BE%E9%80%89/">ç²¾é€‰</a></span>
        <span><a class="tag" href="https://tomtomyoung.top/tags/vue/">vue</a></span>
      </div>
    </div>

    <ul class="menu">
    <li class="menu-item">
        <i class="iconfont icon-top item-btn" id="back_top_btn"></i>
    </li>
    <li class="menu-item">
        <a href="https://tomtomyoung.top/" id="back-btn">
            <i class="iconfont icon-home item-btn"></i>
        </a>
    </li>
    <li class="menu-item">
        <i class="iconfont icon-switch item-btn" id="switch_btn"></i>
    </li>
    <li class="menu-item">
        <i class="iconfont icon-search item-btn" id="search_btn"></i>
    </li>
    <li class="menu-item">
        
        <a class="" href="https://tomtomyoung.top/post/mvc%E4%B8%8Emvvm%E8%AF%A6%E8%A7%A3/" data-tooltip="MVCä¸MVVMè¯¦è§£">
            <i class="iconfont icon-left item-btn"></i>
            
        </a>
    </li>
    <li class="menu-item">
        
        <a class="" href="https://tomtomyoung.top/post/vue-vdom%E4%B8%8Ediff%E8%AF%A6%E8%A7%A3/" data-tooltip="vue vdomä¸diffè¯¦è§£">
            <i class="iconfont icon-right item-btn"></i>
            
        </a>
    </li>
</ul>

  </div>
</div>

<div class="cover" id="cover">
        <div class="search-container">
    <input type="search" class="docsearch-input search-input" placeholder="æœç´¢å…³é”®è¯" />
    
</div>
    </div>
</body>






<script type="text/javascript" src="https://tomtomyoung.top/js/util.min.cbb11aa834d67fe3a408c90d91eb61968cf8837e7b654992031f36b824366a124619697154c0999a624b36918f443262ed9aab968b3a84540f3fce9658230023.js" integrity=""></script></html>