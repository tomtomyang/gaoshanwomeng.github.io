<!DOCTYPE html>
<html lang="zh-cn" data-theme="light"><head>
  <meta name="google-site-verification" content="kw1N-Xm6qEr1c9PGuRd0U_T6DXkw_EHsLyz5LpuDDv8" />
  <meta name="msvalidate.01" content="EE98205D30806C22C519683EFC53E9BA" />
  <meta name="baidu-site-verification" content="iPC3wUcQLL" />
  <title> js Promiseè¯¦è§£</title>
  <meta charset="utf-8" /><meta name="generator" content="Hugo 0.74.3" /><meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1" />
  <meta name="description" itemprop="description"
    content=" js Promiseè¯¦è§£ " />
  <meta name="keywords" itemprop="keywords"
    content=" [js Promise] " />
  <base href="https://tomtomyoung.top/" />


  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC&display=swap" media="print"
    onload="this.media='all'">

  
  <link rel="shortcut icon" href="https://tomtomyoung.top/favicons//favicon.ico" type="image/x-icon" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://tomtomyoung.top/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://tomtomyoung.top/favicons/favicon-16x16.png" />
  <link rel="mask-icon" href="https://tomtomyoung.top/favicons/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="apple-touch-icon" sizes="180x180" href="https://tomtomyoung.top/favicons/apple-touch-icon.png">
  <meta name="msapplication-TileColor" content="#00aba9">
  <meta name="msapplication-TileImage" content="https://tomtomyoung.top/favicons/mstile-144x144.png">
  <link rel="manifest" href="https://tomtomyoung.top/manifest.json">

  
  <link rel="canonical" href="https://tomtomyoung.top/post/js-promise%E8%AF%A6%E8%A7%A3/" />
  <link rel="stylesheet" type="text/css" href="https://at.alicdn.com/t/font_2450869_5vzvggza71i.css" />
  
  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="https://tomtomyoung.top/css/style.min.css" integrity="" type="text/css" />

  
  
  
  <script type="text/javascript" src="https://tomtomyoung.top/js/docsearch.min.js" integrity=""></script>
</head><body class="animated fadeInDown">
<div class="main"><div class="percentage_container">
    <div class="percentage" id="percentage"></div>
</div><div class="toc sub-container">
    <div class="toc-header">
        <span>ç›®å½•</span>
    </div><ul class="toc-h2"><li>
                <span class="toc-link">1. Promise å®šä¹‰</span>
            </li>
            <li>
                <span class="toc-link">2. æ„é€  Promise å®ä¾‹</span>
            </li>
            <li>
                <span class="toc-link">3. Promise.prototype</span>
            </li>
            
                    <ul class="toc-h3"><li>
                <span class="toc-link">1. then()</span>
            </li>
            <li>
                <span class="toc-link">2. catch()</span>
            </li>
            <li>
                <span class="toc-link">3. finally()</span>
            </li>
            
                    </ul><li>
                <span class="toc-link">4. Promise</span>
            </li>
            
                    <ul class="toc-h3"><li>
                <span class="toc-link">1. Promise.resolve()</span>
            </li>
            <li>
                <span class="toc-link">2. Promise.reject()</span>
            </li>
            <li>
                <span class="toc-link">3. Promise.all()</span>
            </li>
            <li>
                <span class="toc-link">4. Promise.allSettled()</span>
            </li>
            <li>
                <span class="toc-link">5. Promise.race()</span>
            </li>
            <li>
                <span class="toc-link">6. Promise.any()</span>
            </li>
            </div><div class="single-post container">
    <div class="post">
      <div class="header">
        <span class="title">js Promiseè¯¦è§£</span>
        
        <div class="info">
          <span>ğŸ“… 2021-07-10</span>
          <span>ğŸ‘¦ Tomtom Young</span>
          <span>ğŸ“– 8222å­—</span>
          <span>â± 17åˆ†é’Ÿ</span>
        </div>
        
      </div>
      <div class="content markdown-body">
        <h2 id="1-promise-å®šä¹‰">1. Promise å®šä¹‰</h2>
<blockquote>
<p><a href="https://promisesaplus.com/">promise A+</a></p>
</blockquote>
<blockquote>
<p>A <em>promise</em> represents the eventual result of an asynchronous operation. The primary way of interacting with a promise is through its <code>then</code> method, which registers callbacks to receive either a promiseâ€™s eventual value or the reason why the promise cannot be fulfilled.</p>
</blockquote>
<p>promiseè¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆç»“æœã€‚ä¸promiseäº¤äº’çš„ä¸»è¦æ–¹å¼æ˜¯é€šè¿‡å®ƒçš„thenæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ³¨å†Œå›è°ƒæ¥æ¥æ”¶promiseçš„æœ€ç»ˆå€¼æˆ–æ— æ³•å®ç°promiseçš„åŸå› ã€‚</p>
<blockquote>
<p><strong>Terminology</strong></p>
<ol>
<li>â€œpromiseâ€ is an object or function with a <code>then</code> method whose behavior conforms to this specification.</li>
<li>â€œthenableâ€ is an object or function that defines a <code>then</code> method.</li>
<li>â€œvalueâ€ is any legal JavaScript value (including <code>undefined</code>, a thenable, or a promise).</li>
<li>â€œexceptionâ€ is a value that is thrown using the <code>throw</code> statement.</li>
<li>â€œreasonâ€ is a value that indicates why a promise was rejected.</li>
</ol>
</blockquote>
<p><strong>æœ¯è¯­</strong></p>
<ol>
<li>â€œpromiseâ€æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–æ–¹æ³•ï¼Œå…¶è¡Œä¸ºç¬¦åˆæœ¬è§„èŒƒçš„è§„å®š</li>
<li>â€œthenableâ€ æ˜¯ä¸€ä¸ªè¢«å®šä¹‰ä¸ºthenå‡½æ•°çš„å¯¹è±¡æˆ–æ–¹æ³•</li>
<li>â€œvalueâ€ å¯ä»¥æ˜¯ä»»ä½•åˆæ³•çš„jså˜é‡ï¼ŒåŒ…æ‹¬undefinedã€thenableã€promise</li>
<li>â€œexceptionâ€ æ˜¯ä¸€ä¸ªä½¿ç”¨throwæŠ›å‡ºçš„å€¼</li>
<li>â€œreasonâ€ æ˜¯ä¸€ä¸ªç”¨æ¥è§£é‡Špromise rejectedçš„åŸå› çš„å€¼</li>
</ol>
<blockquote>
<p>A promise must be in one of three states: pending, fulfilled, or rejected.</p>
<ol>
<li>When pending, a promise:
<ol>
<li>may transition to either the fulfilled or rejected state.</li>
</ol>
</li>
<li>When fulfilled, a promise:
<ol>
<li>must not transition to any other state.</li>
<li>must have a value, which must not change.</li>
</ol>
</li>
<li>When rejected, a promise:
<ol>
<li>must not transition to any other state.</li>
<li>must have a reason, which must not change.</li>
</ol>
</li>
</ol>
<p>Here, â€œmust not changeâ€ means immutable identity (i.e. <code>===</code>), but does not imply deep immutability.</p>
</blockquote>
<p>ä¸€ä¸ªpromiseå¿…é¡»å¤„äºä¸‰ç§çŠ¶æ€ä¹‹ä¸€ï¼špending, fulfilled, rejected</p>
<ol>
<li>å½“å¤„äºpendingçŠ¶æ€æ—¶ï¼Œå¯èƒ½è½¬æ¢ä¸ºfulfilledæˆ–è€…rejectedçŠ¶æ€</li>
<li>å½“å¤„äºfulfilledçŠ¶æ€æ—¶ï¼Œä¸èƒ½å†è½¬æ¢ä¸ºå…¶ä»–çŠ¶æ€ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªè¢«èµ‹äºˆä¸€ä¸ªä¸å¯æ›´æ”¹çš„å€¼</li>
<li>å½“å¤„äºrejectedçŠ¶æ€æ—¶ï¼Œä¸èƒ½å†è½¬æ¢ä¸ºå…¶ä»–çŠ¶æ€ï¼Œå¿…é¡»æŒ‡å®šä¸€ä¸ªä¸å¯æ”¹å˜çš„åŸå› </li>
</ol>
<p>è¿™é‡Œçš„ä¸å¯æ”¹å˜æŒ‡çš„æ˜¯èº«ä»½ä¸å˜ã€‚æŒ‡å‘çš„å†…å­˜åœ°å€ä¸å˜ã€‚</p>
<h2 id="2-æ„é€ -promise-å®ä¾‹">2. æ„é€  Promise å®ä¾‹</h2>
<blockquote>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/Promise">MDN Promise Constructor</a></p>
</blockquote>
<p><strong><code>Promise</code></strong> æ„é€ å™¨ä¸»è¦ç”¨äºåŒ…è£…ä¸æ”¯æŒpromiseï¼ˆè¿”å›å€¼ä¸æ˜¯<code>Promise</code>ï¼‰çš„å‡½æ•°ã€‚</p>
<p><strong>è¯­æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>(executor)
</code></pre></div><p><strong>å‚æ•°</strong></p>
<ul>
<li><code>executor</code>
<ul>
<li>æ˜¯ä¸€ä¸ªåŒå‚å‡½æ•°ï¼Œå‚æ•°ä¸º<code>resolveå’Œreject</code>ã€‚</li>
<li><code>Promise</code>çš„å®ç°ä¼šç«‹å³æ‰§è¡Œ<code>executor</code>ï¼Œå¹¶ä¼ å…¥<code>resolveå’Œreject</code>å‡½æ•°ï¼ˆ<code>Promise</code>æ„é€ å™¨å°†ä¼šåœ¨è¿”å›æ–°å¯¹è±¡ä¹‹å‰<code>executor</code>ï¼‰ã€‚</li>
<li>å½“<code>resolve</code>å’Œ<code>reject</code>å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹promiseæ‰§è¡Œ<code>resolve</code>å’Œ<code>reject</code>ã€‚</li>
<li><code>executor</code>é€šå¸¸ä¼šè§¦å‘ä¸€äº›å¼‚æ­¥è¿ç®—ï¼Œä¸€æ—¦è¿ç®—æˆåŠŸå®Œæˆï¼Œåˆ™<code>resolve</code>æ‰è¿™ä¸ªpromiseï¼Œå¦‚æœå‡ºé”™åˆ™<code>reject</code>æ‰ã€‚</li>
<li><strong>å¦‚æœ<code>executor</code>å‡½æ•°æ‰§è¡Œæ—¶æŠ›å‡ºå¼‚å¸¸ï¼ŒpromiseçŠ¶æ€ä¼šå˜ä¸º<code>rejected</code>ã€‚<code>executor</code>çš„è¿”å›å€¼ä¹Ÿä¼šè¢«å¿½ç•¥</strong>ã€‚</li>
</ul>
</li>
</ul>
<p><strong>è¿”å›å€¼</strong></p>
<p>è¿”å›ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ã€‚</p>
<p><strong>ç¤ºä¾‹</strong></p>
<p>æ™®é€šæƒ…å†µ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">const</span> myPromise <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>	resolve(<span style="color:#bd93f9">1</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>});
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>myPromise.then( val =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>  	console.log(val);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}, res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>	console.log(res); 	 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// 1
</span></code></pre></div><p>åœ¨resolveä¹‹åç»§ç»­æ‰§è¡Œ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">const</span> myPromise <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    resolve(<span style="color:#bd93f9">1</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    console.log(<span style="color:#f1fa8c">&#39;ç»§ç»­æ‰§è¡Œ1&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>});
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>myPromise.then( val =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  	console.log(<span style="color:#f1fa8c">&#39;resolve&#39;</span>, val);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>}, res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>	console.log(<span style="color:#f1fa8c">&#39;reject&#39;</span>, res); 	 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">// ç»§ç»­æ‰§è¡Œ 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4">// resolve 1
</span></code></pre></div><p>å¦‚æœåœ¨executorä¸­æŠ›å‡ºé”™è¯¯ï¼Ÿ</p>
<p>åœ¨resolveä¹‹å‰æŒ‰æŠ›å‡ºé”™è¯¯</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">const</span> myPromise <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Error</span>(<span style="color:#f1fa8c">&#39;å‡ºé”™äº†&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>	resolve(<span style="color:#bd93f9">1</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>});
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>myPromise.then( val =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  	console.log(<span style="color:#f1fa8c">&#39;resolve&#39;</span>, val);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>}, res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>	console.log(<span style="color:#f1fa8c">&#39;reject&#39;</span>, res); 	 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">// reject Error: å‡ºé”™äº†
</span></code></pre></div><p>åœ¨resolveä¹‹åæŠ›å‡ºé”™è¯¯</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">const</span> myPromise <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    resolve(<span style="color:#bd93f9">1</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    console.log(<span style="color:#f1fa8c">&#39;ç»§ç»­æ‰§è¡Œ1&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Error</span>(<span style="color:#f1fa8c">&#39;å‡ºé”™äº†&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    console.log(<span style="color:#f1fa8c">&#39;ç»§ç»­æ‰§è¡Œ2&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>});
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>myPromise.then( val =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>  	console.log(<span style="color:#f1fa8c">&#39;resolve&#39;</span>, val);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>}, res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>	console.log(<span style="color:#f1fa8c">&#39;reject&#39;</span>, res); 	 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// ç»§ç»­æ‰§è¡Œ 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// resolve 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// è¯´æ˜resolveæ²¡æœ‰æ‰“æ–­å‡½æ•°æ‰§è¡Œï¼Œä½†æ˜¯throwæ‰“æ–­äº†
</span></code></pre></div><h2 id="3-promiseprototype">3. Promise.prototype</h2>
<blockquote>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/then">MDN promise</a></p>
</blockquote>
<h3 id="1-then">1. then()</h3>
<p><strong>è¯­æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>p.then(onFulfilled, onRejected);
</code></pre></div><p><strong>å‚æ•°</strong></p>
<ul>
<li><code>onFulfilled</code> å¯é€‰
<ul>
<li>å½“ Promise å˜æˆæ¥å—çŠ¶æ€ï¼ˆfulfilledï¼‰æ—¶è°ƒç”¨çš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function"><code>å‡½æ•°</code></a>ã€‚</li>
<li>è¯¥å‡½æ•°æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå³æ¥å—çš„æœ€ç»ˆç»“æœï¼ˆthe fulfillment  valueï¼‰ã€‚</li>
<li><strong>å¦‚æœè¯¥å‚æ•°ä¸æ˜¯å‡½æ•°ï¼Œåˆ™ä¼šåœ¨å†…éƒ¨è¢«æ›¿æ¢ä¸º <code>(x) =&gt; x</code>ï¼Œå³åŸæ ·è¿”å› promise æœ€ç»ˆç»“æœçš„å‡½æ•°</strong></li>
</ul>
</li>
<li><code>onRejected</code> å¯é€‰
<ul>
<li>å½“ Promise å˜æˆæ‹’ç»çŠ¶æ€ï¼ˆrejectedï¼‰æ—¶è°ƒç”¨çš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function"><code>å‡½æ•°</code></a>ã€‚</li>
<li>è¯¥å‡½æ•°æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå³æ‹’ç»çš„åŸå› ï¼ˆ<code>rejection reason</code>ï¼‰ã€‚</li>
<li><strong>å¦‚æœè¯¥å‚æ•°ä¸æ˜¯å‡½æ•°ï¼Œåˆ™ä¼šåœ¨å†…éƒ¨è¢«æ›¿æ¢ä¸ºä¸€ä¸ª &ldquo;Thrower&rdquo; å‡½æ•° ã€‚</strong></li>
</ul>
</li>
</ul>
<p><strong>è¿”å›å€¼</strong></p>
<p>è¿”å›ä¸€ä¸ª <code>Promiseå¯¹è±¡</code>ï¼Œä½†æ˜¯æ–°Promiseå¯¹è±¡çš„çŠ¶æ€æ˜¯å’Œthençš„å›è°ƒå‡½æ•°ç›¸å…³çš„ã€‚</p>
<p>å½“ä¸€ä¸ª <code>Promise</code>å®Œæˆï¼ˆfulfilledï¼‰æˆ–è€…å¤±è´¥ï¼ˆrejectedï¼‰æ—¶ï¼Œè¿”å›å‡½æ•°ï¼ˆå¾®ä»»åŠ¡ï¼‰å°†è¢«å¼‚æ­¥è°ƒç”¨ï¼ˆç”±äº‹ä»¶å¾ªç¯å¾ªç¯æ¥è°ƒåº¦å®Œæˆï¼‰ã€‚å…·ä½“çš„è¿”å›å€¼ä¾æ®ä»¥ä¸‹è§„åˆ™è¿”å›ã€‚å¦‚æœ <code>then</code> ä¸­çš„å›è°ƒå‡½æ•°ï¼š</p>
<ul>
<li>
<p>returnäº†ä¸€ä¸ªå€¼</p>
<p>é‚£ä¹ˆ <code>then</code> è¿”å›çš„ Promise å°†ä¼šæˆä¸ºfulfilledçŠ¶æ€ï¼Œå¹¶ä¸”å°†è¿”å›çš„å€¼ä½œä¸ºæ¥å—çŠ¶æ€çš„å›è°ƒå‡½æ•°çš„å‚æ•°å€¼ã€‚</p>
</li>
<li>
<p>æ²¡æœ‰returnä»»ä½•å€¼</p>
<p>é‚£ä¹ˆ <code>then</code> è¿”å›çš„ Promise å°†ä¼šæˆä¸ºfulfilledçŠ¶æ€ï¼Œå¹¶ä¸”è¯¥æ¥å—çŠ¶æ€çš„å›è°ƒå‡½æ•°çš„å‚æ•°å€¼ä¸º <code>undefined</code>ã€‚</p>
</li>
<li>
<p>æŠ›å‡ºä¸€ä¸ªé”™è¯¯</p>
<p>é‚£ä¹ˆ <code>then</code> è¿”å›çš„ Promise å°†ä¼šæˆä¸ºrejectedçŠ¶æ€ï¼Œå¹¶ä¸”å°†æŠ›å‡ºçš„é”™è¯¯ä½œä¸ºæ‹’ç»çŠ¶æ€çš„å›è°ƒå‡½æ•°çš„å‚æ•°å€¼ã€‚</p>
</li>
<li>
<p>è¿”å›ä¸€ä¸ªå·²ç»æ˜¯fulfilledçŠ¶æ€çš„ Promise</p>
<p>é‚£ä¹ˆ <code>then</code> è¿”å›çš„ Promise ä¹Ÿä¼šæˆä¸ºfulfilledçŠ¶æ€ï¼Œå¹¶ä¸”å°†é‚£ä¸ª Promise çš„fulfilledçŠ¶æ€çš„å›è°ƒå‡½æ•°çš„å‚æ•°å€¼ä½œä¸ºè¯¥è¢«è¿”å›çš„Promiseçš„fulfilledçŠ¶æ€å›è°ƒå‡½æ•°çš„å‚æ•°å€¼ã€‚</p>
</li>
<li>
<p>è¿”å›ä¸€ä¸ªå·²ç»æ˜¯rejectedçŠ¶æ€çš„ Promise</p>
<p>é‚£ä¹ˆ <code>then</code> è¿”å›çš„ Promise ä¹Ÿä¼šæˆä¸ºrejectedçŠ¶æ€ï¼Œå¹¶ä¸”å°†é‚£ä¸ª Promise çš„rejectedçŠ¶æ€çš„å›è°ƒå‡½æ•°çš„å‚æ•°å€¼ä½œä¸ºè¯¥è¢«è¿”å›çš„Promiseçš„rejectedçŠ¶æ€å›è°ƒå‡½æ•°çš„å‚æ•°å€¼ã€‚</p>
</li>
<li>
<p>è¿”å›ä¸€ä¸ªæœªå®šçŠ¶æ€ï¼ˆ<code>pending</code>ï¼‰çš„ Promise</p>
<p>é‚£ä¹ˆ <code>then</code> è¿”å› Promise çš„çŠ¶æ€ä¹Ÿæ˜¯æœªå®šçš„ï¼Œå¹¶ä¸”å®ƒçš„ç»ˆæ€ä¸é‚£ä¸ª Promise çš„ç»ˆæ€ç›¸åŒï¼›åŒæ—¶ï¼Œå®ƒå˜ä¸ºç»ˆæ€æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°å‚æ•°ä¸é‚£ä¸ª Promise å˜ä¸ºç»ˆæ€æ—¶çš„å›è°ƒå‡½æ•°çš„å‚æ•°æ˜¯ç›¸åŒçš„ã€‚</p>
</li>
</ul>
<p><strong>ç¤ºä¾‹</strong></p>
<ol>
<li>returnäº†ä¸€ä¸ªå€¼</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    setTimeout(_=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>        resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    },<span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;then1&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>}).then(res=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;then2&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// then2 then1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// è¯´æ˜ä¸¤ä»¶äº‹ï¼š
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// 1.è¿”å›çš„promiseå¯¹è±¡æ˜¯fulfilledçŠ¶æ€
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4">// 2.returnçš„å€¼ä½œä¸ºè¿”å›çš„æ–°promiseçš„valueå€¼
</span></code></pre></div><ol start="2">
<li>æ²¡æœ‰returnä»»ä½•å€¼</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    setTimeout(_=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>        resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    },<span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>}).then(res=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// then2 undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// è¯´æ˜ï¼š
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// 1.è¿”å›çš„promiseå¯¹è±¡æ˜¯fulfilledçŠ¶æ€
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// 2.æ²¡æœ‰returnæ—¶ï¼Œvalueå€¼ä¸ºundefined
</span></code></pre></div><ol start="3">
<li>æŠ›å‡ºä¸€ä¸ªé”™è¯¯</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    setTimeout(_=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>        resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    },<span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Error</span>(<span style="color:#f1fa8c">&#39;å‡ºé”™äº†&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>}).then(res=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}, err=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    console.log(<span style="color:#f1fa8c">&#39;err2&#39;</span>, err);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// then2 Error: å‡ºé”™äº† at promise.html:18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// è¯´æ˜ï¼š
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4">// 1.å¦‚æœåœ¨thençš„å›è°ƒå‡½æ•°ä¸­æŠ›å‡ºé”™è¯¯ï¼Œè¿”å›çš„promiseå¯¹è±¡æ˜¯rejectedçŠ¶æ€ï¼Œreasonä¸ºæŠ›å‡ºçš„é”™è¯¯
</span></code></pre></div><ol start="4">
<li>è¿”å›ä¸€ä¸ªå·²ç»æ˜¯fulfilledçŠ¶æ€çš„ Promise</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    setTimeout(_=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>        resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    },<span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#ff79c6">return</span> <span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#f1fa8c">&#39;then1 promise&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>}).then(res=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}, err=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    console.log(<span style="color:#f1fa8c">&#39;err2&#39;</span>, err);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// then2 then1 promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// è¯´æ˜ï¼š
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4">// 1.è¿”å›çš„æ˜¯ä¸€ä¸ªfulfilledçŠ¶æ€çš„promiseå¯¹è±¡
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4">// 2.valueå€¼ä¸ºè¿”å›çš„fulfilledçŠ¶æ€çš„promiseå¯¹è±¡çš„valueå€¼ï¼Œç©¿é€äº†
</span></code></pre></div><ol start="5">
<li>è¿”å›ä¸€ä¸ªå·²ç»æ˜¯rejectedçŠ¶æ€çš„ Promise</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    setTimeout(_=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>        resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    },<span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#ff79c6">return</span> <span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#f1fa8c">&#39;then1 promise&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>}).then(res=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}, err=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    console.log(<span style="color:#f1fa8c">&#39;err2&#39;</span>, err);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// err2 then1 promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// è¯´æ˜ï¼š
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4">// 1.è¿”å›çš„æ˜¯ä¸€ä¸ªrejectedçŠ¶æ€çš„promiseå¯¹è±¡
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4">// 2.reasonå€¼ä¸ºè¿”å›çš„rejectedçŠ¶æ€çš„promiseå¯¹è±¡çš„reasonå€¼ï¼Œç©¿é€äº†
</span></code></pre></div><ol start="6">
<li>è¿”å›ä¸€ä¸ªæœªå®šçŠ¶æ€ï¼ˆ<code>pending</code>ï¼‰çš„ Promise</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        setTimeout(_=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>            resolve(<span style="color:#f1fa8c">&#39;resolve2&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>        }, <span style="color:#bd93f9">4000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}).then(res=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>}, err=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    console.log(<span style="color:#f1fa8c">&#39;err2&#39;</span>, err);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4">// 4ç§’åè¾“å‡º
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4">// then2 resolve2
</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        setTimeout(_=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>            reject(<span style="color:#f1fa8c">&#39;resolve2&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>        }, <span style="color:#bd93f9">4000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}).then(res=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>}, err=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    console.log(<span style="color:#f1fa8c">&#39;err2&#39;</span>, err);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4">// 4ç§’åè¾“å‡º
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4">// err2 resolve2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#6272a4">// è¯´æ˜ï¼š
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#6272a4">// 1.è¿”å›çš„æ˜¯ä¸€ä¸ªpendingçŠ¶æ€çš„promiseå¯¹è±¡
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#6272a4">// 2.å½“pendingçš„promiseå˜ä¸ºrejectedæˆ–è€…fulfilledçš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº”çš„å›è°ƒå‡½æ•°
</span></code></pre></div><blockquote>
<p><strong>æ³¨æ„</strong></p>
<ul>
<li>å¦‚æœå¿½ç•¥é’ˆå¯¹æŸä¸ªçŠ¶æ€çš„å›è°ƒå‡½æ•°å‚æ•°ï¼Œæˆ–è€…æä¾›éå‡½æ•° (nonfunction) å‚æ•°ï¼Œé‚£ä¹ˆ <code>then</code> æ–¹æ³•å°†ä¼šä¸¢å¤±å…³äºè¯¥çŠ¶æ€çš„å›è°ƒå‡½æ•°ä¿¡æ¯ï¼Œä½†æ˜¯å¹¶ä¸ä¼šäº§ç”Ÿé”™è¯¯ã€‚</li>
<li><strong>å¦‚æœè°ƒç”¨ <code>then</code> çš„ <code>Promise</code> çš„çŠ¶æ€ï¼ˆfulfillment æˆ– rejectionï¼‰å‘ç”Ÿæ”¹å˜ï¼Œä½†æ˜¯ <code>then</code> ä¸­å¹¶æ²¡æœ‰å…³äºè¿™ç§çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œé‚£ä¹ˆ <code>then</code> å°†åˆ›å»ºä¸€ä¸ªæ²¡æœ‰ç»è¿‡å›è°ƒå‡½æ•°å¤„ç†çš„æ–° <code>Promise</code> å¯¹è±¡ã€‚</strong></li>
<li><strong>è¿™ä¸ªæ–° <code>Promise</code> åªæ˜¯ç®€å•åœ°æ¥å—è°ƒç”¨è¿™ä¸ª <code>then</code> çš„åŸ <code>Promise</code> çš„ç»ˆæ€ä½œä¸ºå®ƒçš„ç»ˆæ€ã€‚</strong></li>
</ul>
</blockquote>
<h3 id="2-catch">2. catch()</h3>
<p><code>catch()</code> æ–¹æ³•è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå¹¶ä¸”å¤„ç†æ‹’ç»çš„æƒ…å†µã€‚å®ƒçš„è¡Œä¸ºä¸è°ƒç”¨<code>Promise.prototype.then(undefined, onRejected)</code>ç›¸åŒã€‚ (äº‹å®ä¸Š, <code>obj.catch(onRejected)</code>å†…éƒ¨å°±æ˜¯ <code>obj.then(undefined, onRejected)</code>)ã€‚</p>
<p><strong>è¯­æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>p.<span style="color:#ff79c6">catch</span>(onRejected);
</code></pre></div><p><strong>å‚æ•°</strong></p>
<ul>
<li>
<p>onRejected</p>
<p>å½“Promise è¢«rejectedæ—¶,è¢«è°ƒç”¨çš„ä¸€ä¸ª<code>Function</code>ã€‚ è¯¥å‡½æ•°æ‹¥æœ‰ä¸€ä¸ªå‚æ•°reasonï¼Œè¡¨ç¤ºrejection çš„åŸå› ã€‚</p>
</li>
<li>
<p>catchä¸thenåŸºæœ¬ç›¸åŒ</p>
</li>
</ul>
<p><strong>è¿”å›å€¼</strong></p>
<p>ä¸€ä¸ª<code>Promiseå¯¹è±¡</code>ã€‚</p>
<h3 id="3-finally">3. finally()</h3>
<p><code>finally()</code> æ–¹æ³•è¿”å›ä¸€ä¸ª<code>Promiseå¯¹è±¡</code>ã€‚åœ¨promiseç»“æŸæ—¶ï¼Œæ— è®ºç»“æœæ˜¯fulfilledæˆ–è€…æ˜¯rejectedï¼Œéƒ½ä¼šæ‰§è¡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚è¿™ä¸ºåœ¨<code>Promise</code>æ˜¯å¦æˆåŠŸå®Œæˆåéƒ½éœ€è¦æ‰§è¡Œçš„ä»£ç æä¾›äº†ä¸€ç§æ–¹å¼ã€‚</p>
<p>è¿™é¿å…äº†åŒæ ·çš„è¯­å¥éœ€è¦åœ¨<code>then()</code>å’Œ<code>catch()</code>ä¸­å„å†™ä¸€æ¬¡çš„æƒ…å†µã€‚</p>
<p><strong>è¯­æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>p.<span style="color:#ff79c6">finally</span>(onFinally);
</code></pre></div><p><strong>å‚æ•°</strong></p>
<ul>
<li>
<p>onFinally</p>
<p><code>Promise</code> ç»“æŸåè°ƒç”¨çš„<code>Function</code>ã€‚</p>
</li>
</ul>
<p><strong>è¿”å›å€¼</strong></p>
<p>ä¸€ä¸ª<code>Promiseå¯¹è±¡</code>ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong></p>
<p><code>finally()</code> è™½ç„¶ä¸ <code>.then(onFinally, onFinally)</code> ç±»ä¼¼ï¼Œå®ƒä»¬ä¸åŒçš„æ˜¯ï¼š</p>
<ul>
<li>ç”±äºæ— æ³•çŸ¥é“<code>promise</code>çš„æœ€ç»ˆçŠ¶æ€ï¼Œæ‰€ä»¥<code>finally</code>çš„å›è°ƒå‡½æ•°ä¸­ä¸æ¥æ”¶ä»»ä½•å‚æ•°ï¼Œå®ƒä»…ç”¨äºæ— è®ºæœ€ç»ˆç»“æœå¦‚ä½•éƒ½è¦æ‰§è¡Œçš„æƒ…å†µã€‚</li>
<li>ä¸<code>Promise.resolve(2).then(() =&gt; {}, () =&gt; {})</code> ï¼ˆresolvedçš„ç»“æœä¸º<code>undefined</code>ï¼‰ä¸åŒï¼Œ<code>Promise.resolve(2).finally(() =&gt; {})</code> resolvedçš„ç»“æœä¸º <code>2</code>ã€‚</li>
<li>åŒæ ·ï¼Œ<code>Promise.reject(3).then(() =&gt; {}, () =&gt; {})</code> (fulfilledçš„ç»“æœä¸º<code>undefined</code>), <code>Promise.reject(3).finally(() =&gt; {})</code> rejected çš„ç»“æœä¸º <code>3</code>ã€‚</li>
</ul>
</blockquote>
<p><strong>ç¤ºä¾‹</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then( res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;then1&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>}).<span style="color:#ff79c6">finally</span>( res =&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    console.log(<span style="color:#f1fa8c">&#39;finally&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>}).then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// finally undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// then2 then1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// è¯´æ˜ï¼š
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// 1.finallyä¸æ¥æ”¶ä»»ä½•å‚æ•°
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4">// 2.åé¢çš„thenå¯ä»¥ç©¿é€finallyæ¥æ”¶å‰ä¸€å±‚çš„promiseå¯¹è±¡
</span></code></pre></div><p>å¦‚æœfinallyé‡Œè¿”å›äº†å€¼ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then( res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;then1&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>}).<span style="color:#ff79c6">finally</span>( res =&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    console.log(<span style="color:#f1fa8c">&#39;finally&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;finally&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>}).then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// finally undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// then2 then1
</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then( res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;then1&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>}).<span style="color:#ff79c6">finally</span>( res =&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    console.log(<span style="color:#f1fa8c">&#39;finally&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    <span style="color:#ff79c6">return</span> <span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#f1fa8c">&#39;finally&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>}).then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// finally undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// then2 then1
</span></code></pre></div><p>æ˜¯ä¸æ˜¯finallyä¸åœ¨promiseçš„è°ƒç”¨é“¾ä¸­ï¼Œä¸‹ä¸€å±‚æ¥æ”¶çš„æ°¸è¿œæ˜¯ä¸Šä¸€å±‚è¿”å›çš„Promiseå¯¹è±¡ï¼Ÿ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> promise1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject)=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    resolve(<span style="color:#f1fa8c">&#39;resolve&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> promise1.then( res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    console.log(<span style="color:#f1fa8c">&#39;then1&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>}).<span style="color:#ff79c6">finally</span>( res =&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    console.log(<span style="color:#f1fa8c">&#39;finally&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#ff79c6">return</span> <span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#f1fa8c">&#39;finally&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>}).then(res =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    console.log(<span style="color:#f1fa8c">&#39;then2&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4">// console output:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// then1 resolve
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// finally undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// then2 undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// æ›´æ”¹äº†å‰ä¸€å±‚è¿”å›çš„promiseï¼Œä¸‹ä¸€å±‚ä¹Ÿæ¥æ”¶ä¸åˆ°äº†ï¼ŒåŸºæœ¬å¯ä»¥åˆ¤å®šfinallyä¸åœ¨promiseçš„è°ƒç”¨é“¾ä¸­ï¼Œæˆ–è€…è¯´è¢«ç©¿é€äº†
</span></code></pre></div><h2 id="4-promise">4. Promise</h2>
<blockquote>
<p><a href="https://zh.javascript.info/promise-api">promise api</a></p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise">MDN Promise</a></p>
</blockquote>
<h3 id="1-promiseresolve">1. Promise.resolve()</h3>
<p><strong>è¯­æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(value);
</code></pre></div><p><strong>å‚æ•°</strong></p>
<ul>
<li>
<p>value</p>
<p>è¢«<code>Promise</code>å¯¹è±¡è§£æçš„å‚æ•°ï¼Œå¯ä»¥æ˜¯æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªthenableã€‚</p>
</li>
</ul>
<p><strong>è¿”å›</strong></p>
<ul>
<li>å¦‚æœå‚æ•°ä¸ºæ™®é€šæ•°æ®ç±»å‹ï¼Œè¿”å›ä¸€ä¸ªå¸¦ç€ç»™å®šå€¼çŠ¶æ€ä¸ºfulfilledçš„<code>Promise</code>å¯¹è±¡</li>
<li>å¦‚æœå‚æ•°æœ¬èº«å°±æ˜¯ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œåˆ™ç›´æ¥è¿”å›è¿™ä¸ª<code>Promise</code>å¯¹è±¡ï¼ŒçŠ¶æ€å’Œå€¼éƒ½æ˜¯ä¼ å…¥çš„è¿™ä¸ª<code>promise</code>ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹</strong></p>
<p>resolveæ™®é€šæ•°æ®ç±»å‹</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#f1fa8c">&#34;Success&#34;</span>).then(value =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>  console.log(value); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>  <span style="color:#6272a4">// &#34;Success&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#6272a4"></span>  <span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: undefined}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4"></span>}, res=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  <span style="color:#6272a4">// ä¸ä¼šè¢«è°ƒç”¨
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4"></span>});
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#8be9fd;font-style:italic">Promise</span>.resolve([<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">3</span>]).then(value =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>  console.log(value); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>  <span style="color:#6272a4">// [1,2,3]
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>  <span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: undefined}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4"></span>}, res=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>  <span style="color:#6272a4">// ä¸ä¼šè¢«è°ƒç”¨
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4"></span>});
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#8be9fd;font-style:italic">Promise</span>.resolve({a<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">1</span>}).then(value =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>  console.log(value); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>  <span style="color:#6272a4">// {a: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#6272a4"></span>  <span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: undefined}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#6272a4"></span>}, res=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>  <span style="color:#6272a4">// ä¸ä¼šè¢«è°ƒç”¨
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#6272a4"></span>});
</code></pre></div><p>resolveä¸€ä¸ªpromiseå¯¹è±¡</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">1</span>)).then(value =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  console.log(<span style="color:#f1fa8c">&#39;resolve&#39;</span>, value); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>}, res=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>  console.log(<span style="color:#f1fa8c">&#39;reject&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>});
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span style="color:#6272a4">// reject 1
</span></code></pre></div><p>resolveä¸€ä¸ªthenableå¯¹è±¡</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">var</span> p1 <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">Promise</span>.resolve({
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>  then<span style="color:#ff79c6">:</span> <span style="color:#8be9fd;font-style:italic">function</span>(onFulfill, onReject) { 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>      onFulfill(<span style="color:#f1fa8c">&#34;fulfilled!&#34;</span>); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>});
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>console.log(p1 <span style="color:#ff79c6">instanceof</span> <span style="color:#8be9fd;font-style:italic">Promise</span>) 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4">// true, è¿™æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>p1.then(<span style="color:#8be9fd;font-style:italic">function</span>(v) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    console.log(v); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    <span style="color:#6272a4">// è¾“å‡º&#34;fulfilled!&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>  }, <span style="color:#8be9fd;font-style:italic">function</span>(e) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    <span style="color:#6272a4">// ä¸ä¼šè¢«è°ƒç”¨
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4"></span>});
</code></pre></div><h3 id="2-promisereject">2. Promise.reject()</h3>
<p><strong>è¯­æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.reject(reason);
</code></pre></div><p><strong>å‚æ•°</strong></p>
<ul>
<li>
<p>reason</p>
<p>è¡¨ç¤º<code>Promise</code>è¢«æ‹’ç»çš„åŸå› ã€‚</p>
</li>
</ul>
<p><strong>è¿”å›</strong></p>
<p>ä¸€ä¸ªç»™å®šreasonäº†çš„rejectedçŠ¶æ€çš„çš„ <code>Promise</code>ã€‚</p>
<p><strong>ç¤ºä¾‹</strong></p>
<p>æ™®é€šæƒ…å†µ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">1</span>).then(value =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  console.log(<span style="color:#f1fa8c">&#39;resolve&#39;</span>, value); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>}, res=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>  console.log(<span style="color:#f1fa8c">&#39;reject&#39;</span>, res); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>});
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span style="color:#6272a4">// reject 1
</span></code></pre></div><p>å¦‚æœæˆ‘ä¼ å…¥ä¸€ä¸ªpromiseå¯¹è±¡</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">1</span>)).then(value =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  console.log(<span style="color:#f1fa8c">&#39;resolve&#39;</span>, value); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>}, res=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>  console.log(<span style="color:#f1fa8c">&#39;reject&#39;</span>, res);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>});
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span style="color:#6272a4">// reject PromiseÂ {&lt;fulfilled&gt;: 1}
</span></code></pre></div><p>è¿™é‡Œå’Œresolveä¸åŒäº†ï¼Œresolveå¦‚æœä¼ å…¥ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œåˆ™ä¼šè¿”å›è¿™ä¸ªå¯¹è±¡ï¼ŒçŠ¶æ€çš„å€¼éƒ½ä¼šä¸€æ ·ï¼Œrejectä¼ å…¥ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œå¿…å®šä¼šè¿”å›ä¸€ä¸ªrejectedçš„å¯¹è±¡ï¼Œrejectedçš„reasonæ˜¯è¿™ä¸ªpromiseå¯¹è±¡</p>
<h3 id="3-promiseall">3. Promise.all()</h3>
<blockquote>
<ul>
<li>æ¥æ”¶ä¸€ç»„promiseçš„iterableç±»å‹ï¼ˆæ³¨ï¼šArrayï¼ŒMapï¼ŒSetéƒ½å±äºES6çš„iterableç±»å‹ï¼‰çš„è¾“å…¥</li>
<li>è¿”å›ä¸€ä¸ª<code>Promise</code>å®ä¾‹ï¼Œ è¾“å…¥çš„æ‰€æœ‰promiseçš„resolveå›è°ƒçš„ç»“æœç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä½œä¸ºè¿™ä¸ªPromiseçš„fulfilledçš„value</li>
<li>æ•°ç»„é‡ŒæŒ‰é¡ºåºå­˜å‚¨äº†æ¯ä¸€ä¸ªPromiseçš„fulfilledçš„valueå€¼ï¼Œè¿™ä¸ªé¡ºåºæ˜¯è¾“å…¥æ—¶çš„é¡ºåºï¼Œè€Œä¸æ˜¯resolveçš„æ—¶é—´é¡ºåº</li>
<li>æ–°çš„<code>Promise</code>çš„resolveå›è°ƒæ‰§è¡Œæ—¶æœºæ˜¯åœ¨æ‰€æœ‰è¾“å…¥çš„promiseçš„resolveå›è°ƒéƒ½ç»“æŸï¼Œæˆ–è€…è¾“å…¥çš„iterableé‡Œæ²¡æœ‰promiseäº†çš„æ—¶å€™</li>
<li>æ–°çš„<code>Promise</code>çš„rejectå›è°ƒæ‰§è¡Œæ—¶æœºæ˜¯ï¼Œåªè¦ä»»ä½•ä¸€ä¸ªè¾“å…¥çš„promiseçš„rejectå›è°ƒæ‰§è¡Œæˆ–è€…è¾“å…¥ä¸åˆæ³•çš„promiseå°±ä¼šç«‹å³æŠ›å‡ºé”™è¯¯ï¼Œå¹¶ä¸”rejectçš„æ˜¯ç¬¬ä¸€ä¸ªæŠ›å‡ºçš„é”™è¯¯ä¿¡æ¯</li>
</ul>
</blockquote>
<p><strong>è¯­æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.all(iterable);
</code></pre></div><p><strong>å‚æ•°</strong></p>
<ul>
<li>
<p>iterable</p>
<p>ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œå¦‚ <code>Array</code>æˆ– <code>String</code>ã€‚</p>
</li>
</ul>
<p><strong>è¿”å›</strong></p>
<ul>
<li>å¦‚æœæ²¡æœ‰ä¼ å…¥å‚æ•°æ—¶ï¼Œè¿”å›ä¸€ä¸ªrejectedçŠ¶æ€çš„<code>Promise</code>ã€‚</li>
<li>å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªç©ºçš„å¯è¿­ä»£å¯¹è±¡ï¼Œåˆ™è¿”å›ä¸€ä¸ªfulfilledçŠ¶æ€çš„ <code>Promise</code>ã€‚</li>
<li>å¦‚æœä¼ å…¥çš„å‚æ•°ä¸åŒ…å«ä»»ä½• <code>promise</code>ï¼Œåˆ™è¿”å›ä¸€ä¸ªfulfilledçŠ¶æ€çš„<code>Promise</code>ã€‚</li>
<li>å…¶å®ƒæƒ…å†µä¸‹è¿”å›ä¸€ä¸ªpendingçŠ¶æ€çš„<code>Promise</code>ã€‚è¿™ä¸ªè¿”å›çš„ <code>promise</code> ä¹‹åä¼šåœ¨æ‰€æœ‰çš„ <code>promise</code> éƒ½å®Œæˆæˆ–æœ‰ä¸€ä¸ª <code>promise</code> å¤±è´¥æ—¶å˜ä¸ºå®Œæˆæˆ–å¤±è´¥ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹</strong></p>
<p>å¦‚æœç¬¬ä¸€ä¸ªpromiseè€—è´¹çš„æ—¶é—´æ¯”å…¶ä»–promiseå¤šï¼Œä¼šä¸ä¼šæ‰“ä¹±è¾“å‡ºçš„é¡ºåºï¼Ÿ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.all([
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>  <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    setTimeout(() =&gt; resolve(<span style="color:#bd93f9">1</span>), <span style="color:#bd93f9">5000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>  }),
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    setTimeout(() =&gt; resolve(<span style="color:#bd93f9">2</span>), <span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  }),
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>  <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    setTimeout(() =&gt; resolve(<span style="color:#bd93f9">3</span>), <span style="color:#bd93f9">3000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>  })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>]).then(
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    res =&gt; console.log(res)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// 1ç§’åè¾“å‡º[1,2,3]
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// ç»“æœæ•°ç»„ä¸­å…ƒç´ çš„é¡ºåºä¸å…¶åœ¨æº promise ä¸­çš„é¡ºåºç›¸åŒã€‚
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// å³ä½¿ç¬¬ä¸€ä¸ª promise èŠ±è´¹äº†æœ€é•¿çš„æ—¶é—´æ‰ resolveï¼Œä½†å®ƒä»æ˜¯ç»“æœæ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ª
</span></code></pre></div><p>å¦‚æœæ²¡æœ‰è¾“å…¥iterableæˆ–è€…è¾“å…¥çš„iterableä¸ºç©ºï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.all([]).then(
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    res =&gt; console.log(res)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4">// []
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: undefined}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#8be9fd;font-style:italic">Promise</span>.all().then(
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    res =&gt; console.log(res)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4">// PromiseÂ {&lt;rejected&gt;: TypeError: undefined is not iterable (cannot read property Symbol(Symbol.iterator))
</span></code></pre></div><p>å¦‚æœè¾“å…¥çš„iterableä¸­å­˜åœ¨épromiseæ•°æ®ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.all([
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>  <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    resolve(<span style="color:#bd93f9">1</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>  }),
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  <span style="color:#bd93f9">2</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  <span style="color:#bd93f9">3</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  { a<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">1</span> },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>  <span style="color:#f1fa8c">&#39;no promise&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>  [<span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">2</span>, <span style="color:#bd93f9">3</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>]).then(
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    res =&gt; console.log(res)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// 1ç§’åè¾“å‡º (6)Â [1, 2, 3, {â€¦}, &#34;no promise&#34;, Array(3)]
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: undefined}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// Promise.all(...) æ¥å—å«æœ‰ promise é¡¹çš„å¯è¿­ä»£å¯¹è±¡ï¼ˆå¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯æ•°ç»„ï¼‰ä½œä¸ºå‚æ•°
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// å¦‚æœè¿™äº›å¯¹è±¡ä¸­çš„ä»»ä½•ä¸€ä¸ªä¸æ˜¯ promiseï¼Œé‚£ä¹ˆå®ƒå°†è¢«â€œæŒ‰åŸæ ·â€ä¼ é€’ç»™ç»“æœæ•°ç»„ã€‚
</span></code></pre></div><p>å¦‚æœè¾“å…¥çš„iterableä¸­æ²¡æœ‰promiseï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.all([
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>  <span style="color:#bd93f9">1</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>  <span style="color:#bd93f9">2</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>  <span style="color:#bd93f9">3</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  { a<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">1</span> },
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  <span style="color:#f1fa8c">&#39;no promise&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  [<span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">2</span>, <span style="color:#bd93f9">3</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>]).then(
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    res =&gt; console.log(res)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>); 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4">// (6)Â [1, 2, 3, {â€¦}, &#34;no promise&#34;, Array(3)]
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: undefined}
</span></code></pre></div><blockquote>
<p><strong>Promise.all()çš„å¼‚æ­¥å’ŒåŒæ­¥</strong></p>
<p>åªæœ‰å½“Promise.all()ä¼ å…¥çš„iterableä¸ºç©ºæ—¶ï¼ŒPromise.all()æ‰æ˜¯åŒæ­¥çš„ã€‚</p>
<p><strong>ç¤ºä¾‹</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>console.log(<span style="color:#8be9fd;font-style:italic">Promise</span>.all([]));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>console.log(<span style="color:#8be9fd;font-style:italic">Promise</span>.all([<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">3</span>]));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>console.log(<span style="color:#8be9fd;font-style:italic">Promise</span>.all(<span style="color:#f1fa8c">&#39;&#39;</span>));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>console.log(<span style="color:#8be9fd;font-style:italic">Promise</span>.all(<span style="color:#f1fa8c">&#39;hahahha&#39;</span>));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>console.log(<span style="color:#8be9fd;font-style:italic">Promise</span>.all(<span style="color:#ff79c6">new</span> Map()));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>console.log(<span style="color:#8be9fd;font-style:italic">Promise</span>.all(<span style="color:#bd93f9">123456</span>));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>console.log(<span style="color:#8be9fd;font-style:italic">Promise</span>.all([<span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">1</span>), <span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">2</span>)]));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>console.log(<span style="color:#8be9fd;font-style:italic">Promise</span>.all([<span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">1</span>), <span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">2</span>)]));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4">// console output
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">// ç©ºè¿­ä»£å¯¹è±¡ï¼ŒåŒæ­¥è¿”å›
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: Array(0)}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// éç©ºè¿­ä»£å¯¹è±¡ï¼Œå¼‚æ­¥è¿”å›
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// PromiseÂ {&lt;pending&gt;}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// ç©ºè¿­ä»£å¯¹è±¡ï¼ŒåŒæ­¥è¿”å›
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: Array(0)}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// éç©ºè¿­ä»£å¯¹è±¡ï¼Œå¼‚æ­¥è¿”å›
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4">// PromiseÂ {&lt;pending&gt;}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4">// ç©ºè¿­ä»£å¯¹è±¡ï¼ŒåŒæ­¥è¿”å›
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: Array(0)}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#6272a4">// éè¿­ä»£å¯¹è±¡ï¼ŒåŒæ­¥è¿”å›
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#6272a4">// PromiseÂ {&lt;rejected&gt;: TypeError: number 123456 is not iterable (cannot read property Symbol(Symbol.iterator))at Funcâ€¦}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#6272a4">// éç©ºè¿­ä»£å¯¹è±¡ï¼ŒåŒ…å«promiseï¼Œä¸€éƒ¨è¿”å›
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#6272a4">// PromiseÂ {&lt;pending&gt;}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#6272a4">// PromiseÂ {&lt;pending&gt;}
</span></code></pre></div></blockquote>
<blockquote>
<p><strong>å…¶ä»–</strong></p>
<p>ä¸€ä¸ªå¸¸è§çš„æŠ€å·§æ˜¯ï¼Œå°†ä¸€ä¸ªä»»åŠ¡æ•°æ®æ•°ç»„æ˜ å°„ï¼ˆmapï¼‰åˆ°ä¸€ä¸ª promise æ•°ç»„ï¼Œç„¶åå°†å…¶åŒ…è£…åˆ° <code>Promise.all</code>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå­˜å‚¨ URL çš„æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥åƒè¿™æ · fetch å®ƒä»¬ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> urls <span style="color:#ff79c6">=</span> [
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>  <span style="color:#f1fa8c">&#39;https://api.github.com/users/iliakan&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>  <span style="color:#f1fa8c">&#39;https://api.github.com/users/remy&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>  <span style="color:#f1fa8c">&#39;https://api.github.com/users/jeresig&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>];
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4">// å°†æ¯ä¸ª url æ˜ å°„ï¼ˆmapï¼‰åˆ° fetch çš„ promise ä¸­
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">let</span> requests <span style="color:#ff79c6">=</span> urls.map(url =&gt; fetch(url));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4">// Promise.all ç­‰å¾…æ‰€æœ‰ä»»åŠ¡éƒ½ resolved
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">Promise</span>.all(requests)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>  .then(responses =&gt; responses.forEach(
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    response =&gt; alert(<span style="color:#f1fa8c">`</span><span style="color:#f1fa8c">${</span>response.url<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">: </span><span style="color:#f1fa8c">${</span>response.status<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>  ));
</code></pre></div></blockquote>
<h3 id="4-promiseallsettled">4. Promise.allSettled()</h3>
<p><code>Promise.allSettled()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªåœ¨æ‰€æœ‰ç»™å®šçš„promiseéƒ½å·²ç»<code>fulfilled</code>æˆ–<code>rejected</code>åçš„promiseï¼Œå¹¶å¸¦æœ‰ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡è¡¨ç¤ºå¯¹åº”çš„promiseç»“æœã€‚</p>
<p>å’Œ<code>Promise.all()</code>ç›¸æ¯”ï¼Œ<code>Promise.allSettled()</code>è§£é™¤äº†å„ä¸ªPromiseä¹‹é—´çš„å…³è”ï¼Œåªæ˜¯æä¾›ä¸€ä¸ªæ‰€æœ‰Promiseè¾¾åˆ°ç»ˆæ€çš„æ—¶æœºã€‚</p>
<p><strong>è¯­æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.allSettled(iterable);
</code></pre></div><p><strong>å‚æ•°</strong></p>
<ul>
<li>
<p>iterable</p>
<p>ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡ï¼Œä¾‹å¦‚<code>Array</code>ï¼Œå…¶ä¸­æ¯ä¸ªæˆå‘˜éƒ½æ˜¯<code>Promise</code>ã€‚</p>
</li>
</ul>
<p><strong>è¿”å›</strong></p>
<blockquote>
<p>ä¸€æ—¦æ‰€æŒ‡å®šçš„ promises é›†åˆä¸­æ¯ä¸€ä¸ª promise å·²ç»å®Œæˆï¼Œæ— è®ºæ˜¯æˆåŠŸçš„è¾¾æˆæˆ–è¢«æ‹’ç»ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„åŒ…å«åŸå§‹ promises é›†ä¸­æ¯ä¸ª promise çš„ç»“æœã€‚</p>
<p>æ•°ç»„ä¸­çš„æ¯ä¸ªç»“æœå¯¹è±¡ï¼Œéƒ½æœ‰ä¸€ä¸ª <code>status</code> å­—ç¬¦ä¸²ã€‚å¦‚æœå®ƒçš„å€¼ä¸º <code>fulfilled</code>ï¼Œåˆ™ç»“æœå¯¹è±¡ä¸Šå­˜åœ¨ä¸€ä¸ª <code>value</code> ã€‚å¦‚æœå€¼ä¸º <code>rejected</code>ï¼Œåˆ™å­˜åœ¨ä¸€ä¸ª <code>reason</code> ã€‚</p>
</blockquote>
<p><strong>ç¤ºä¾‹</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.allSettled([<span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">1</span>),<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">2</span>)]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: Array(2)}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4">// [[PromiseResult]]: Array(2)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4">//     0: {status: &#34;fulfilled&#34;, value: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4">//     1: {status: &#34;rejected&#34;, reason: 2}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#6272a4">//     length: 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#8be9fd;font-style:italic">Promise</span>.allSettled([<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">1</span>),<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">2</span>)]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: Array(2)}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// [[PromiseResult]]: Array(2)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">//     0: {status: &#34;rejected&#34;, value: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">//     1: {status: &#34;rejected&#34;, reason: 2}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">//     length: 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#8be9fd;font-style:italic">Promise</span>.allSettled();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#6272a4">// Promise {&lt;rejected&gt;: TypeError: undefined is not iterable...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#6272a4">// [[PromiseState]]: &#34;rejected&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#6272a4">// [[PromiseResult]]: TypeError: undefined is not iterable...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#8be9fd;font-style:italic">Promise</span>.allSettled([]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: Array(0)}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span style="color:#6272a4">// [[PromiseResult]]: Array(0)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span style="color:#8be9fd;font-style:italic">Promise</span>.allSettled([<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">3</span>]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: Array(3)}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span style="color:#6272a4">// [[PromiseResult]]: Array(3)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span style="color:#6272a4">// 0: {status: &#34;fulfilled&#34;, value: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span style="color:#6272a4">// 1: {status: &#34;fulfilled&#34;, value: 2}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span style="color:#6272a4">// 2: {status: &#34;fulfilled&#34;, value: 3}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span style="color:#6272a4">// length: 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span style="color:#8be9fd;font-style:italic">Promise</span>.allSettled(<span style="color:#bd93f9">123456</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span style="color:#6272a4">// Promise {&lt;rejected&gt;: TypeError: number 123456 is not iterable...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span style="color:#6272a4">// [[PromiseState]]: &#34;rejected&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span style="color:#6272a4">// [[PromiseResult]]: TypeError: number 123456 is not iterable
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span style="color:#8be9fd;font-style:italic">Promise</span>.allSettled(<span style="color:#ff79c6">new</span> Map([[<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">2</span>],[<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">3</span>]]));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span style="color:#6272a4">// [[PromiseResult]]: Array(2)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span style="color:#6272a4">//		0:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span style="color:#6272a4">//		status: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span style="color:#6272a4">//		value: (2) [1, 2]
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span style="color:#6272a4">//		[[Prototype]]: Object
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span style="color:#6272a4">//		1:
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span style="color:#6272a4">//		status: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span style="color:#6272a4">//		value: (2) [2, 3]
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span><span style="color:#6272a4">//		[[Prototype]]: Object
</span></code></pre></div><h3 id="5-promiserace">5. Promise.race()</h3>
<p><strong><code>Promise.race(iterable)</code></strong> æ–¹æ³•è¿”å›ä¸€ä¸ª promiseï¼Œä¸€æ—¦è¿­ä»£å™¨ä¸­çš„æŸä¸ªpromiseè§£å†³æˆ–æ‹’ç»ï¼Œè¿”å›çš„ promiseå°±ä¼šè§£å†³æˆ–æ‹’ç»ã€‚</p>
<p><strong>è¯­æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race(iterable);
</code></pre></div><p><strong>å‚æ•°</strong></p>
<ul>
<li>
<p>iterable</p>
<p>ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡ï¼Œä¾‹å¦‚<code>Array</code>ï¼Œå…¶ä¸­æ¯ä¸ªæˆå‘˜éƒ½æ˜¯<code>Promise</code>ã€‚</p>
</li>
</ul>
<p><strong>è¿”å›</strong></p>
<p>ä¸€ä¸ªå¾…å®šçš„<code>Promise</code>ï¼Œåªè¦ç»™å®šçš„ä¸€ç»„promiseä¸­çš„ä¸€ä¸ªå˜ä¸ºç»ˆæ€ï¼Œå°±é‡‡ç”¨ç¬¬ä¸€ä¸ªpromiseçš„å€¼ä½œä¸ºå®ƒçš„å€¼ï¼Œå¼‚æ­¥åœ°resolveæˆ–rejectã€‚</p>
<blockquote>
<ul>
<li><code>race</code> å‡½æ•°è¿”å›ä¸€ä¸ª <code>Promise</code>ï¼Œå®ƒå°†ä¸ç¬¬ä¸€ä¸ªä¼ é€’çš„ promise ç›¸åŒçš„å®Œæˆæ–¹å¼è¢«å®Œæˆã€‚å®ƒå¯ä»¥æ˜¯å®Œæˆï¼ˆ resolvesï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤±è´¥ï¼ˆrejectsï¼‰ï¼Œè¿™è¦å–å†³äºç¬¬ä¸€ä¸ªå®Œæˆçš„æ–¹å¼æ˜¯ä¸¤ä¸ªä¸­çš„å“ªä¸ªã€‚</li>
<li>å¦‚æœä¼ çš„è¿­ä»£æ˜¯ç©ºçš„ï¼Œåˆ™è¿”å›çš„ promise å°†æ°¸è¿œç­‰å¾…ã€‚</li>
<li>å¦‚æœè¿­ä»£åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªépromiseæˆ–æ˜¯å·²ç»å¤„äºç»ˆæ€çš„Promiseï¼Œåˆ™<code> Promise.race</code> å°†è§£æä¸ºè¿­ä»£ä¸­æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªå€¼ã€‚</li>
</ul>
</blockquote>
<p><strong>ç¤ºä¾‹</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race([<span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">1</span>),<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">2</span>)]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race([<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">1</span>),<span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">2</span>)]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#6272a4">// Promise {&lt;rejected&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4">// [[PromiseState]]: &#34;rejected&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race([<span style="color:#bd93f9">1</span>,<span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">2</span>)]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race([<span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>    resolve(<span style="color:#bd93f9">1</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>}), <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>    resolve(<span style="color:#bd93f9">2</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>})]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race([<span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>    setTimeout(()=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>        resolve(<span style="color:#bd93f9">1</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>    }, <span style="color:#bd93f9">3000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>}), <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>    setTimeout(()=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>        resolve(<span style="color:#bd93f9">1</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>    }, <span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>})]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span style="color:#6272a4">// [[PromiseState]]: &#34;pending&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span style="color:#6272a4">// [[PromiseResult]]: undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race([<span style="color:#bd93f9">1</span>, <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span>    setTimeout(()=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span>        resolve(<span style="color:#bd93f9">1</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span>    }, <span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span>})]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span style="color:#6272a4">// Promise {&lt;rejected&gt;: TypeError: undefined is not iterable...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span style="color:#6272a4">// [[PromiseState]]: &#34;rejected&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span style="color:#6272a4">// [[PromiseResult]]: TypeError: undefined is not iterable...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race([]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span><span style="color:#6272a4">// PromiseÂ {&lt;pending&gt;}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span><span style="color:#6272a4">// [[PromiseState]]: &#34;pending&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span><span style="color:#6272a4">// [[PromiseResult]]: undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race([<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">3</span>]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71</span><span style="color:#8be9fd;font-style:italic">Promise</span>.race(<span style="color:#bd93f9">123456</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72</span><span style="color:#6272a4">// Promise {&lt;rejected&gt;: TypeError: number 123456 is not iterable...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74</span><span style="color:#6272a4">// [[PromiseState]]: &#34;rejected&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75</span><span style="color:#6272a4">// [[PromiseResult]]: TypeError: number 123456 is not iterable
</span></code></pre></div><h3 id="6-promiseany">6. Promise.any()</h3>
<p><code>Promise.any()</code> æ¥æ”¶ä¸€ä¸ª<code>Promise</code>å¯è¿­ä»£å¯¹è±¡ï¼Œåªè¦å…¶ä¸­çš„ä¸€ä¸ª <code>promise</code> æˆåŠŸï¼Œå°±è¿”å›é‚£ä¸ªå·²ç»æˆåŠŸçš„ <code>promise</code> ã€‚å¦‚æœå¯è¿­ä»£å¯¹è±¡ä¸­æ²¡æœ‰ä¸€ä¸ª <code>promise</code> æˆåŠŸï¼ˆå³æ‰€æœ‰çš„ <code>promises</code> éƒ½å¤±è´¥ï¼‰ï¼Œå°±è¿”å›ä¸€ä¸ªå¤±è´¥çš„ <code>promise </code>å’Œ<code>AggregateError</code>ç±»å‹çš„å®ä¾‹ï¼Œå®ƒæ˜¯ <code>Error</code>çš„ä¸€ä¸ªå­ç±»ï¼Œç”¨äºæŠŠå•ä¸€çš„é”™è¯¯é›†åˆåœ¨ä¸€èµ·ã€‚</p>
<p>æœ¬è´¨ä¸Šï¼Œè¿™ä¸ªæ–¹æ³•å’Œ<code>Promise.all()</code>æ˜¯ç›¸åçš„ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong></p>
<p><code>Promise.any()</code> æ–¹æ³•ä¾ç„¶æ˜¯å®éªŒæ€§çš„ï¼Œå°šæœªè¢«æ‰€æœ‰çš„æµè§ˆå™¨å®Œå…¨æ”¯æŒã€‚å®ƒå½“å‰å¤„äº <a href="https://github.com/tc39/proposal-promise-any">TC39 ç¬¬å››é˜¶æ®µè‰æ¡ˆï¼ˆStage 4ï¼‰</a></p>
</blockquote>
<p><strong>è¯­æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any(iterable);
</code></pre></div><p><strong>å‚æ•°</strong></p>
<ul>
<li>
<p>iterable</p>
<p>ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡ï¼Œä¾‹å¦‚<code>Array</code>ï¼Œå…¶ä¸­æ¯ä¸ªæˆå‘˜éƒ½æ˜¯<code>Promise</code>ã€‚</p>
</li>
</ul>
<p><strong>è¿”å›</strong></p>
<ul>
<li>å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªç©ºçš„å¯è¿­ä»£å¯¹è±¡ï¼Œåˆ™è¿”å›ä¸€ä¸ª <strong>å·²å¤±è´¥ï¼ˆalready rejectedï¼‰</strong> çŠ¶æ€çš„ Promiseã€‚</li>
<li>å¦‚æœä¼ å…¥çš„å‚æ•°ä¸åŒ…å«ä»»ä½• <code>promise</code>ï¼Œåˆ™è¿”å›ä¸€ä¸ª <strong>å¼‚æ­¥å®Œæˆ</strong> ï¼ˆ<strong>asynchronously resolved</strong>ï¼‰çš„ Promiseã€‚</li>
<li>å…¶ä»–æƒ…å†µä¸‹éƒ½ä¼šè¿”å›ä¸€ä¸ª<strong>å¤„ç†ä¸­ï¼ˆpendingï¼‰</strong> çš„ Promiseã€‚ åªè¦ä¼ å…¥çš„è¿­ä»£å¯¹è±¡ä¸­çš„ä»»ä½•ä¸€ä¸ª <code>promise</code> å˜æˆæˆåŠŸï¼ˆresolveï¼‰çŠ¶æ€ï¼Œæˆ–è€…å…¶ä¸­çš„æ‰€æœ‰çš„ <code>promises</code> éƒ½å¤±è´¥ï¼Œé‚£ä¹ˆè¿”å›çš„ <code>promise</code> å°±ä¼š <strong>å¼‚æ­¥åœ°</strong>ï¼ˆå½“è°ƒç”¨æ ˆä¸ºç©ºæ—¶ï¼‰ å˜æˆæˆåŠŸ/å¤±è´¥ï¼ˆresolved/rejectï¼‰çŠ¶æ€ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any([<span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">1</span>),<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">2</span>)]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any([<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">1</span>),<span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">2</span>)]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: 2}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">// [[PromiseResult]]: 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any([<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">1</span>),<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">2</span>)]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: 2}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">// [[PromiseState]]: &#34;rejected&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">// [[PromiseResult]]: AggregateError: All promises were rejected
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any([<span style="color:#bd93f9">1</span>,<span style="color:#8be9fd;font-style:italic">Promise</span>.resolve(<span style="color:#bd93f9">2</span>)]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any([<span style="color:#8be9fd;font-style:italic">Promise</span>.reject(<span style="color:#bd93f9">1</span>), <span style="color:#bd93f9">2</span>]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: 2}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span style="color:#6272a4">// [[PromiseResult]]: 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any([<span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>    setTimeout(()=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>        resolve(<span style="color:#bd93f9">1</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>    }, <span style="color:#bd93f9">3000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>}), <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>    setTimeout(()=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>        resolve(<span style="color:#bd93f9">2</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span>    }, <span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span>})]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span style="color:#6272a4">// Promise {&lt;pending&gt;}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span style="color:#6272a4">// [[PromiseState]]: &#34;pending&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span style="color:#6272a4">// [[PromiseResult]]: undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span style="color:#6272a4">// 1ç§’åå˜ä¸º
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span style="color:#6272a4">// Promise {&lt;fulfilled&gt;: 2}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span style="color:#6272a4">// [[PromiseResult]]: 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any([<span style="color:#bd93f9">1</span>, <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Promise</span>((resolve, reject) =&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span>    setTimeout(()=&gt; {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span>        resolve(<span style="color:#bd93f9">1</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span>    }, <span style="color:#bd93f9">1000</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span>})]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span><span style="color:#6272a4">// Promise {&lt;rejected&gt;: TypeError: undefined is not iterable...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span><span style="color:#6272a4">// [[PromiseState]]: &#34;rejected&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span><span style="color:#6272a4">// [[PromiseResult]]: TypeError: undefined is not iterable...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any([]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span><span style="color:#6272a4">// PromiseÂ {&lt;rejected&gt;}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69</span><span style="color:#6272a4">// [[PromiseState]]: &#34;rejected&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70</span><span style="color:#6272a4">// [[PromiseResult]]: AggregateError: All promises were rejected
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any([<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">3</span>]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73</span><span style="color:#6272a4">// PromiseÂ {&lt;fulfilled&gt;: 1}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75</span><span style="color:#6272a4">// [[PromiseState]]: &#34;fulfilled&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76</span><span style="color:#6272a4">// [[PromiseResult]]: 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78</span><span style="color:#8be9fd;font-style:italic">Promise</span>.any(<span style="color:#bd93f9">123456</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79</span><span style="color:#6272a4">// Promise {&lt;rejected&gt;: TypeError: number 123456 is not iterable...
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80</span><span style="color:#6272a4">// [[Prototype]]: Promise
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81</span><span style="color:#6272a4">// [[PromiseState]]: &#34;rejected&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82</span><span style="color:#6272a4">// [[PromiseResult]]: TypeError: number 123456 is not iterable
</span></code></pre></div><p>æœ¬æ–‡æ˜¯js å¼‚æ­¥ç¼–ç¨‹è¯¦è§£çš„ç¬¬1ç¯‡æ–‡ç« ï¼Œä¸‹ä¸€ç¯‡æ˜¯ã€Šjs æ‰‹å†™Promiseã€‹ã€‚</p>

      </div>
      <div class="footer">
        <span><a class="category" href="https://tomtomyoung.top/categories/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a><a class="category" href="https://tomtomyoung.top/categories/%E7%B2%BE%E9%80%89/">ç²¾é€‰</a></span>
        <span><a class="tag" href="https://tomtomyoung.top/tags/js/">js</a><a class="tag" href="https://tomtomyoung.top/tags/promise/">Promise</a><a class="tag" href="https://tomtomyoung.top/tags/%E5%BC%82%E6%AD%A5/">å¼‚æ­¥</a></span>
      </div>
    </div>

    <ul class="menu">
    <li class="menu-item">
        <i class="iconfont icon-top item-btn" id="back_top_btn"></i>
    </li>
    <li class="menu-item">
        <a href="https://tomtomyoung.top/" id="back-btn">
            <i class="iconfont icon-home item-btn"></i>
        </a>
    </li>
    <li class="menu-item">
        <i class="iconfont icon-switch item-btn" id="switch_btn"></i>
    </li>
    <li class="menu-item">
        <i class="iconfont icon-search item-btn" id="search_btn"></i>
    </li>
    <li class="menu-item">
        
        <a class="" href="https://tomtomyoung.top/post/js-settimeoutsetinterval/" data-tooltip="js setTimeout&amp;setInterval">
            <i class="iconfont icon-left item-btn"></i>
            
        </a>
    </li>
    <li class="menu-item">
        
        <a class="" href="https://tomtomyoung.top/post/%E6%B5%8F%E8%A7%88%E5%99%A8-xsscsrf/" data-tooltip="æµè§ˆå™¨ xss&amp;csrf">
            <i class="iconfont icon-right item-btn"></i>
            
        </a>
    </li>
</ul>

  </div>
</div>

<div class="cover" id="cover">
        <div class="search-container">
    <input type="search" class="docsearch-input search-input" placeholder="æœç´¢å…³é”®è¯" />
    
</div>
    </div>
</body>







<script type="text/javascript" src="https://tomtomyoung.top/js/util.min.js" integrity=""></script>
<script>
    if ('serviceWorker' in navigator) {
        const PREFETCH = true;
        const PREFETCH_LINK_RELS = ['index', 'next', 'prev', 'prefetch'];
        function prefetchCache () {
            if (navigator.serviceWorker.controller) {
                let links = document.querySelectorAll(
                    PREFETCH_LINK_RELS.map((rel) => {
                        return 'link[rel=' + rel + ']';
                    }).join(',')
                );
                if (links.length > 0) {
                    Array.from(links)
                        .map((link) => {
                            let href = link.getAttribute('href');
                            navigator.serviceWorker.controller.postMessage({
                                action: 'cache',
                                url: href,
                            });
                        });
                }
            }
        }

        navigator.serviceWorker
            .register('/serviceWorker.js', { scope: '/' })
            .then(() => {
                console.log('Service Worker Registered');
            });

        navigator.serviceWorker
            .ready
            .then(() => {
                if (PREFETCH) {
                    console.log('Service Worker Ready');
                    prefetchCache();
                }
            });
    }
</script></html>