<!DOCTYPE html>
<html lang="zh-cn" data-theme="light"><head>
  <meta name="google-site-verification" content="kw1N-Xm6qEr1c9PGuRd0U_T6DXkw_EHsLyz5LpuDDv8" />
  <meta name="msvalidate.01" content="EE98205D30806C22C519683EFC53E9BA" />
  <meta name="baidu-site-verification" content="iPC3wUcQLL" />
  <title>react 类组件详解</title>
  <meta charset="utf-8" /><meta name="generator" content="Hugo 0.74.3" /><meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1" />
  <meta name="description" itemprop="description"
    content="react 类组件详解" />
  <meta name="keywords" itemprop="keywords"
    content="[react]" />
  <base href="https://tomtomyoung.top/" />

  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preload prefetch" as="style" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC&display=swap" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC&display=swap" media="print"
    onload="this.media='all'">

  
  <link rel="shortcut icon" href="https://tomtomyoung.top/favicons//favicon.ico" type="image/x-icon" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://tomtomyoung.top/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://tomtomyoung.top/favicons/favicon-16x16.png" />
  <link rel="mask-icon" href="https://tomtomyoung.top/favicons/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="apple-touch-icon" sizes="180x180" href="https://tomtomyoung.top/favicons/apple-touch-icon.png">
  <meta name="msapplication-TileColor" content="#00aba9">
  <meta name="msapplication-TileImage" content="https://tomtomyoung.top/favicons/mstile-144x144.png">
  <link rel="manifest" href="https://tomtomyoung.top/manifest.json">

  
  <link rel="canonical" href="https://tomtomyoung.top/post/react-%E7%B1%BB%E7%BB%84%E4%BB%B6%E8%AF%A6%E8%A7%A3/" />
  <link rel="stylesheet" type="text/css" href="https://at.alicdn.com/t/font_2450869_5vzvggza71i.css" />
  
  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="https://tomtomyoung.top/css/style.min.css" integrity="" type="text/css" />

  
  
  
  <script type="text/javascript" src="https://tomtomyoung.top/js/docsearch.min.js" integrity=""></script>
</head><body>
<div class="main"><div class="percentage_container">
    <div class="percentage" id="percentage"></div>
</div><div class="toc sub-container">
    <div class="toc-header animated fadeInDown">
        <span>目录</span>
    </div><ul class="toc-h3 animated fadeInDown"><li>
                <span class="toc-link">1. ES6的类</span>
            </li>
            <li>
                <span class="toc-link">2. React中的类组件</span>
            </li>
            <li>
                <span class="toc-link">3. 事件绑定</span>
            </li>
            <li>
                <span class="toc-link">4. state</span>
            </li>
            
                    <ul class="toc-h4"><li>
                <span class="toc-link">1. 给类式组件添加state</span>
            </li>
            <li>
                <span class="toc-link">2. 修改组件的state</span>
            </li>
            <li>
                <span class="toc-link">3. 修改state的精简写法</span>
            </li>
            
                    </ul><li>
                <span class="toc-link">5. props</span>
            </li>
            
                    <ul class="toc-h4"><li>
                <span class="toc-link">1. 单个传递props</span>
            </li>
            <li>
                <span class="toc-link">2. 批量传递props</span>
            </li>
            <li>
                <span class="toc-link">3. 对props进行限制</span>
            </li>
            <li>
                <span class="toc-link">4. props限制的简写</span>
            </li>
            
                    </ul><li>
                <span class="toc-link">6. 类式组件的refs</span>
            </li>
            
                    <ul class="toc-h4"><li>
                <span class="toc-link">1. 字符串形式ref</span>
            </li>
            <li>
                <span class="toc-link">2. 回调函数形式的ref</span>
            </li>
            <li>
                <span class="toc-link">3. createRef</span>
            </li>
            </div><div class="single-post container">
    <div class="post animated fadeInDown">
      <div class="header">
        <span class="title">react 类组件详解</span>
        
          <div class="info">
            <span>发布于2021-08-10</span>
            <span>更新于2022-05-17</span>
            <span>共9702字</span>
            <span>阅读20分钟</span>

          </div>
        
      </div>
      <div class="content markdown-body">
        <p>React中有两种定义组件的方式：</p>
<ol>
<li>
<p>函数定义组件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">function</span> Welcome() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span>&gt;函数式&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>}
</code></pre></div></li>
<li>
<p>类定义组件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#ff79c6">class</span> Welcome <span style="color:#ff79c6">extends</span> React.Component {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  render() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span>&gt;类式&lt;/<span style="color:#ff79c6">h1</span>&gt;;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>}
</code></pre></div></li>
</ol>
<p>我们来主要研究类组件的相关内容。</p>
<h3 id="1-es6的类">1. ES6的类</h3>
<p>ES6的新特性让我们可以用class关键字轻松定义一个类，还可以使用继承等操作，</p>
<blockquote>
<p>这里涉及到一个关于原型链的知识，我们定义的<code>Person</code>类本身有一个原型对象，而使用<code>new Person()</code>得到的是Person类的实例对象，注意区别。</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//创建一个Person类
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Person {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    <span style="color:#6272a4">//构造器方法
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#6272a4"></span>    constructor(name,age){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#6272a4">//构造器中的this是谁？—— 类的实例对象
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.name <span style="color:#ff79c6">=</span> name
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#ff79c6">this</span>.age <span style="color:#ff79c6">=</span> age
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    <span style="color:#6272a4">//一般方法
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4"></span>    speak () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        <span style="color:#6272a4">//speak方法放在了哪里？——类的原型对象上，供实例使用
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">//通过Person实例调用speak时，speak中的this就是Person实例
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4"></span>        console.log(<span style="color:#f1fa8c">`我叫</span><span style="color:#f1fa8c">${</span><span style="color:#ff79c6">this</span>.name<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">，我年龄是</span><span style="color:#f1fa8c">${</span><span style="color:#ff79c6">this</span>.age<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">//创建一个Student类，继承于Person类
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Student <span style="color:#ff79c6">extends</span> Person {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>    constructor(name,age,grade){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>        <span style="color:#ff79c6">super</span>(name,age)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>        <span style="color:#ff79c6">this</span>.grade <span style="color:#ff79c6">=</span> grade
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>        <span style="color:#ff79c6">this</span>.school <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;尚硅谷&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>    <span style="color:#6272a4">//重写从父类继承过来的方法
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#6272a4"></span>    speak () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>        console.log(<span style="color:#f1fa8c">`我叫</span><span style="color:#f1fa8c">${</span><span style="color:#ff79c6">this</span>.name<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">，我年龄是</span><span style="color:#f1fa8c">${</span><span style="color:#ff79c6">this</span>.age<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">,我读的是</span><span style="color:#f1fa8c">${</span><span style="color:#ff79c6">this</span>.grade<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">年级`</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>        <span style="color:#ff79c6">this</span>.study()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>    study () {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>        <span style="color:#6272a4">//study方法放在了哪里？——类的原型对象上，供实例使用
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">//通过Student实例调用study时，study中的this就是Student实例
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span style="color:#6272a4"></span>        console.log(<span style="color:#f1fa8c">&#39;我很努力的学习&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span style="color:#ff79c6">class</span> Car {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>    constructor(name,price){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span>        <span style="color:#ff79c6">this</span>.name <span style="color:#ff79c6">=</span> name
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span>        <span style="color:#ff79c6">this</span>.price <span style="color:#ff79c6">=</span> price
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span>    <span style="color:#6272a4">//类中可以直接写赋值语句
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span style="color:#6272a4"></span>    <span style="color:#6272a4">//如下代码的含义是：给Car的实例对象添加一个属性，名为a，值为1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span style="color:#6272a4"></span>    a <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span>    wheel <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span>	<span style="color:#6272a4">//使用static修饰属性，属性绑定在类的原型对象上，而不是实例对象上
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">static</span> demo <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">100</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span>}
</code></pre></div><p><strong>总结：</strong></p>
<ol>
<li>类中的构造器不是必须要写的，要对实例进行一些初始化的操作，如添加指定属性时才写。</li>
<li>如果A类继承了B类，且A类中写了构造器，那么A类构造器中的super是必须要调用的。</li>
<li>类中所定义的方法，都放在了类的原型对象上，供实例去使用。</li>
</ol>
<h3 id="2-react中的类组件">2. React中的类组件</h3>
<p>在React中我们使用类的方式来定义组件，和上面我们定义一个<code>class</code>类的方式一模一样：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//1.创建类式组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> MyComponent <span style="color:#ff79c6">extends</span> React.Component {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        <span style="color:#6272a4">//render是放在哪里的？—— MyComponent的原型对象上，供实例使用。
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">//render中的this是谁？—— MyComponent的实例对象 &lt;=&gt; MyComponent组件实例对象。
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4"></span>        console.log(<span style="color:#f1fa8c">&#39;render中的this:&#39;</span>,<span style="color:#ff79c6">this</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h2</span>&gt;我是用类定义的组件&lt;/<span style="color:#ff79c6">h2</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4">//2.渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">MyComponent</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4">/* 
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span style="color:#6272a4">    
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">*/</span>
</code></pre></div><p>但是我们会发现，与上面类的操作不同，我们定义的<code>MyComponent</code>类并没有使用过<code>new MyComponent()</code>这样的方式进行实例化，那我们在render中所写的<code>render中的this指向类的实例对象</code>这个实例对象根本没有被实例化过，又从何而来？</p>
<p>其实，是React帮我们进行了实例化，在我们调用<code>ReactDOM.render(&lt;MyComponent/&gt;,document.getElementById('test'))</code>这段代码时，React帮我们做了很多事：</p>
<blockquote>
<p>执行了<code>ReactDOM.render(&lt;MyComponent/&gt;.......)</code>之后，发生了什么？</p>
<ol>
<li>React解析组件标签，找到了MyComponent组件。</li>
<li>发现组件是使用类定义的，随后new出来该类的实例，并通过该实例调用到原型上的render方法。</li>
<li>将render返回的虚拟DOM转为真实DOM，随后呈现在页面中。</li>
</ol>
</blockquote>
<p>这样来看，一切就变得很合情合理了，这里也解释了类式组件的复用其实就是对一个类，实例化多个对象。</p>
<h3 id="3-事件绑定">3. 事件绑定</h3>
<p>在讲解类组件的三大属性之前，我们先讲一下该如何进行事件绑定，更方便下面的学习。</p>
<p>首先，在原生的js中我们想对页面中的某个元素进行事件绑定，以点击事件为例，我们会这样写：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">&lt;!DOCTYPE html&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>&lt;<span style="color:#ff79c6">html</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>	&lt;<span style="color:#ff79c6">head</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>		&lt;<span style="color:#ff79c6">meta</span> <span style="color:#50fa7b">charset</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;UTF-8&#34;</span> /&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>		&lt;<span style="color:#ff79c6">title</span>&gt;Document&lt;/<span style="color:#ff79c6">title</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>	&lt;/<span style="color:#ff79c6">head</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>	&lt;<span style="color:#ff79c6">body</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>		&lt;<span style="color:#ff79c6">button</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn1&#34;</span>&gt;按钮1&lt;/<span style="color:#ff79c6">button</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>		&lt;<span style="color:#ff79c6">button</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;btn2&#34;</span>&gt;按钮2&lt;/<span style="color:#ff79c6">button</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>		&lt;<span style="color:#ff79c6">button</span> <span style="color:#50fa7b">onclick</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;demo()&#34;</span>&gt;按钮3&lt;/<span style="color:#ff79c6">button</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>		&lt;<span style="color:#ff79c6">script</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text/javascript&#34;</span> &gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>			<span style="color:#ff79c6">const</span> btn1 <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;btn1&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>			btn1.addEventListener(<span style="color:#f1fa8c">&#39;click&#39;</span>,()=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>				alert(<span style="color:#f1fa8c">&#39;按钮1被点击了&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>			})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>			<span style="color:#ff79c6">const</span> btn2 <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;btn2&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>			btn2.onclick <span style="color:#ff79c6">=</span> ()=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>				alert(<span style="color:#f1fa8c">&#39;按钮2被点击了&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>			}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>			<span style="color:#8be9fd;font-style:italic">function</span> demo(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>				alert(<span style="color:#f1fa8c">&#39;按钮3被点击了&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>			}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>		&lt;/<span style="color:#ff79c6">script</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>	&lt;/<span style="color:#ff79c6">body</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>&lt;/<span style="color:#ff79c6">html</span>&gt;
</code></pre></div><p>那么切换到React中我们想进行事件绑定，我们也照抄这种写法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//1.创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{ 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    demo(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        console.log(<span style="color:#ff79c6">this</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span> <span style="color:#50fa7b">onclick</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;demo()&#34;</span>&gt;类式组件&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">//2.渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>这时候我们会在浏览器控制台得到如下报错：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20210327110835351.png" alt="image-20210327110835351"></p>
<p>这是因为React对js原生的事件绑定写法进行了重新规定，比如<code>onclick</code>被要求写成<code>onClick</code>、<code>onblur</code>被要求写成<code>onBlur</code>等，那么我们改成<code>onClick</code>来试一试：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//1.创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{ 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    demo(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        console.log(<span style="color:#ff79c6">this</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;demo()&#34;</span>&gt;类式组件&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">//2.渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>这时候我们还会得到报错：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20210327111150439.png" alt="image-20210327111150439"></p>
<p>这是因为现在已经不是原生的HTML进行解析，而是jsx，它会把<code>&quot;demo()&quot;</code>识别成一个字符串，而不是一段js代码。这里我们需要改成正确的写法<code>onClick={demo()}</code>，对于<code>{}</code>里面的内容，jsx就可以正确的识别这是一段代码而不是一个字符串。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//1.创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{ 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    demo(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        console.log(<span style="color:#ff79c6">this</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{demo()}&gt;类式组件&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">//2.渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>这里我们又会发现一个问题，我们进入页面，还没有点击<code>h1</code>，<code>demo()</code>就被执行，这是因为：</p>
<p>在渲染页面时，会执行类中的render函数，拿到render函数的返回值进行解析生成虚拟dom，这里的返回值明显是<code>&lt;h1 onClick={demo()}&gt;类式组件&lt;/h1&gt;</code>，那么解析引擎就会解析：</p>
<ol>
<li>这是一个`h1``标签</li>
<li>它绑定了一个点击事件</li>
<li>它绑定的点击事件是<code>demo()</code>这个函数的返回值</li>
</ol>
<p>问题发现了，由于jsx特殊的语法，绑定给点击事件的不是我们定义好的<code>demo()</code>，而是<code>demo()</code>这个函数的返回值，这里就解释了为什么要先执行一下<code>demo()</code>，是为了拿到这个函数的返回值绑定给点击事件，也就是说我们根本就没有把<code>demo()</code>和点击事件绑定起来。</p>
<p>最终正确的写法是：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//1.创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{ 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    demo(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        console.log(<span style="color:#ff79c6">this</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{demo}&gt;类式组件&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4">//2.渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p><code>onClick={demo}</code>这样的写法就是，我们将<code>demo</code>这个函数作为点击事件执行的函数来执行。</p>
<h3 id="4-state">4. state</h3>
<p>首先要明确一点：组件的<code>state</code>是负责存放数据的，这一点和Vue是一样的。</p>
<p>在我们还没有在我们自己写的类式组件中定义<code>state</code>时，我们输出类式组件的实例对象会发现，这个实例对象已经有了<code>state</code>属性，只不过里面是没有数据的：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20210327102924249.png" alt=""></p>
<p>这是<code>extends</code>搞得鬼，通过<code>extends</code>我们继承了父类组件<code>React.Component</code>，而在这个组件中，已经定义好了构造器，给实例对象添加了<code>state</code>、<code>props</code>、<code>refs</code>等属性。</p>
<h4 id="1-给类式组件添加state">1. 给类式组件添加state</h4>
<p>根据官方文档，我们可以是使用下面这种方式给类式组件添加<code>state</code>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//1.创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    <span style="color:#6272a4">//构造器调用几次？ ———— 1次
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4"></span>    constructor(props){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        <span style="color:#ff79c6">super</span>(props)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#6272a4">//初始化状态
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.state <span style="color:#ff79c6">=</span> {isHot<span style="color:#ff79c6">:</span><span style="color:#ff79c6">false</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    <span style="color:#6272a4">//render调用几次？ ———— 1+n次 1是初始化的那次 n是状态更新的次数
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>        <span style="color:#6272a4">//读取状态
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">const</span> {isHot} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span>&gt;今天天气很{isHot <span style="color:#ff79c6">?</span> <span style="color:#f1fa8c">&#39;炎热&#39;</span> <span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;凉爽&#39;</span>}&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4">//2.渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>通过编写构造器方法<code>constructor</code>，我们实现了给类式组件添加了<code>state</code>属性，现在我们的类式组件变成了现在这样：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20210327104835084.png" alt="image-20210327104835084"></p>
<p>可以看到<code>state</code>里面已经有了数据。</p>
<h4 id="2-修改组件的state">2. 修改组件的state</h4>
<p>修改组件的state需要用到函数绑定：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//1.创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>			
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    <span style="color:#6272a4">//构造器调用几次？ ———— 1次
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4"></span>    constructor(props){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        <span style="color:#ff79c6">super</span>(props)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#6272a4">//初始化状态
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.state <span style="color:#ff79c6">=</span> {isHot<span style="color:#ff79c6">:</span><span style="color:#ff79c6">false</span>,wind<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;微风&#39;</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    <span style="color:#6272a4">//changeWeather调用几次？ ———— 点几次调几次
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>    changeWeather(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>        <span style="color:#6272a4">//changeWeather放在哪里？ ———— Weather的原型对象上，供实例使用
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">//由于changeWeather是作为onClick的回调，所以不是通过实例调用的，是直接调用
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">//类中的方法默认开启了局部的严格模式，所以changeWeather中的this为undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4"></span>        console.log(<span style="color:#ff79c6">this</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>    <span style="color:#6272a4">//render调用几次？ ———— 1+n次 1是初始化的那次 n是状态更新的次数
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#6272a4"></span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>        <span style="color:#6272a4">//读取状态
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">const</span> {isHot,wind} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.changeWeather}&gt;今天天气很{isHot <span style="color:#ff79c6">?</span> <span style="color:#f1fa8c">&#39;炎热&#39;</span> <span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;凉爽&#39;</span>}，{wind}&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#6272a4">//2.渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>这里还有一个坑，就是在<code>changeWeather()</code>中我们直接操作<code>this.state</code>会报undefined，这到底是为什么？</p>
<p>这里就涉及到了js中类的知识：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">&lt;!DOCTYPE html&gt;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>&lt;<span style="color:#ff79c6">html</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>	&lt;<span style="color:#ff79c6">head</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>		&lt;<span style="color:#ff79c6">meta</span> <span style="color:#50fa7b">charset</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;UTF-8&#34;</span> /&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>		&lt;<span style="color:#ff79c6">title</span>&gt;Document&lt;/<span style="color:#ff79c6">title</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>	&lt;/<span style="color:#ff79c6">head</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>	&lt;<span style="color:#ff79c6">body</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>		&lt;<span style="color:#ff79c6">script</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text/javascript&#34;</span> &gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>			<span style="color:#ff79c6">class</span> Person {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>				constructor(name,age){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>					<span style="color:#ff79c6">this</span>.name <span style="color:#ff79c6">=</span> name
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>					<span style="color:#ff79c6">this</span>.age <span style="color:#ff79c6">=</span> age
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>				}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>				study(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>                      <span style="color:#6272a4">//类中的方法开启了局部严格模式
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4"></span>					<span style="color:#6272a4">//study方法放在了哪里？——类的原型对象上，供实例使用
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4"></span>					<span style="color:#6272a4">//通过Person实例调用study时，study中的this就是Person实例
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4"></span>					console.log(<span style="color:#ff79c6">this</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>				}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>			}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>			<span style="color:#ff79c6">const</span> p1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> Person(<span style="color:#f1fa8c">&#39;tom&#39;</span>,<span style="color:#bd93f9">18</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>			p1.study() <span style="color:#6272a4">//通过实例调用study方法
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#6272a4"></span>   
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>			<span style="color:#ff79c6">const</span> x <span style="color:#ff79c6">=</span> p1.study
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>             <span style="color:#6272a4">// 没有通过实例调用
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#6272a4"></span>             <span style="color:#6272a4">// this就为undefined
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#6272a4"></span>			x()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>		&lt;/<span style="color:#ff79c6">script</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>	&lt;/<span style="color:#ff79c6">body</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>&lt;/<span style="color:#ff79c6">html</span>&gt;
</code></pre></div><p>这里就解释清楚了，在<code>onClick={this.changeWeather}</code>这里，我们把<code>{this.changeWeather}</code>赋值给了<code>onClick</code>，等到点击时，触发的是<code>onClick</code>，而不是当时的<code>{this.changeWeather}</code>。也就是说，<code>{this.changeWeather}</code>根本就没通过实例来调用，因此里面的<code>this</code>是undefined。</p>
<p>那么我们该怎么解决这个问题，就是使用一行代码：<code>this.changeWeather = this.changeWeather.bind(this)</code>来解决<code>this</code>的指向问题。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    constructor(props){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        <span style="color:#ff79c6">super</span>(props)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#ff79c6">this</span>.state <span style="color:#ff79c6">=</span> {isHot<span style="color:#ff79c6">:</span><span style="color:#ff79c6">false</span>,wind<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;微风&#39;</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        <span style="color:#6272a4">//解决changeWeather中this指向问题
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.changeWeather <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.changeWeather.bind(<span style="color:#ff79c6">this</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        <span style="color:#ff79c6">const</span> {isHot,wind} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.changeWeather}&gt;今天天气很{isHot <span style="color:#ff79c6">?</span> <span style="color:#f1fa8c">&#39;炎热&#39;</span> <span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;凉爽&#39;</span>}，{wind}&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>    changeWeather(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        console.log(<span style="color:#f1fa8c">&#39;changeWeather&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>那么具体是如何改变指向的？</p>
<ol>
<li><code>=</code>右侧是<code>this.changeWeather.bind(this)</code>，在执行<code>constructor</code>时，<code>this.changeWeather</code>还是不存在的，因此顺着原型链，找到了类的原型对象的<code>changeWeather</code>，并且将这个函数使用<code>bind</code>生成了一个新的函数，同时改变了这个新函数中的<code>this</code>的指向，指向了类的实例对象。</li>
<li><code>=</code>左侧是<code>this.changeWeather</code>，也就是说，<code>=</code>右侧生成的这个新函数，我们绑定给我们的实例对象，同时这个新函数的<code>this</code>还指向了我们实例对象。</li>
<li>在<code>onClick={this.changeWeather}</code>时，我们就将实例对象的<code>changeWeather</code>函数绑定给了<code>onClick</code>，而不是从前的原型对象的<code>changeWeather</code>函数。</li>
</ol>
<p>那么最终我们通过函数来更改<code>state</code>的值的写法就变成了：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//1.创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    <span style="color:#6272a4">//构造器调用几次？ ———— 1次
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4"></span>    constructor(props){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        console.log(<span style="color:#f1fa8c">&#39;constructor&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#ff79c6">super</span>(props)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        <span style="color:#6272a4">//初始化状态
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.state <span style="color:#ff79c6">=</span> {isHot<span style="color:#ff79c6">:</span><span style="color:#ff79c6">false</span>,wind<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;微风&#39;</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        <span style="color:#6272a4">//解决changeWeather中this指向问题
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.changeWeather <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.changeWeather.bind(<span style="color:#ff79c6">this</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    <span style="color:#6272a4">//render调用几次？ ———— 1+n次 1是初始化的那次 n是状态更新的次数
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4"></span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        console.log(<span style="color:#f1fa8c">&#39;render&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>        <span style="color:#6272a4">//读取状态
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">const</span> {isHot,wind} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.changeWeather}&gt;今天天气很{isHot <span style="color:#ff79c6">?</span> <span style="color:#f1fa8c">&#39;炎热&#39;</span> <span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;凉爽&#39;</span>}，{wind}&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>    <span style="color:#6272a4">//changeWeather调用几次？ ———— 点几次调几次
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span style="color:#6272a4"></span>    changeWeather(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>        console.log(<span style="color:#f1fa8c">&#39;changeWeather&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>        <span style="color:#6272a4">//获取原来的isHot值
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">const</span> isHot <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state.isHot
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>        <span style="color:#6272a4">//严重注意：状态必须通过setState进行更新,且更新是一种合并，不是替换。
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.setState({isHot<span style="color:#ff79c6">:!</span>isHot})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>        console.log(<span style="color:#ff79c6">this</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>        <span style="color:#6272a4">//严重注意：状态(state)不可直接更改，下面这行就是直接更改！！！
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">//this.state.isHot = !isHot //这是错误的写法
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span style="color:#6272a4"></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span style="color:#6272a4">//2.渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>这里还要注意一点是，每当我们用<code>this.setState()</code>更改state的值的时候，<code>render</code>函数就会重新执行一次。</p>
<h4 id="3-修改state的精简写法">3. 修改state的精简写法</h4>
<p>再上一个章节中，我们最终的代码变成现在这个样子：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    constructor(props){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        <span style="color:#ff79c6">super</span>(props)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#ff79c6">this</span>.state <span style="color:#ff79c6">=</span> {isHot<span style="color:#ff79c6">:</span><span style="color:#ff79c6">false</span>,wind<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;微风&#39;</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        <span style="color:#ff79c6">this</span>.changeWeather <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.changeWeather.bind(<span style="color:#ff79c6">this</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        <span style="color:#ff79c6">const</span> {isHot,wind} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.changeWeather}&gt;今天天气很{isHot <span style="color:#ff79c6">?</span> <span style="color:#f1fa8c">&#39;炎热&#39;</span> <span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;凉爽&#39;</span>}，{wind}&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    changeWeather(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>        <span style="color:#ff79c6">const</span> isHot <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state.isHot
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        <span style="color:#ff79c6">this</span>.setState({isHot<span style="color:#ff79c6">:!</span>isHot})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>由ES6中类的相关知识我们可以知道，我们可以直接在类中写赋值语句，给类的实例对象追加属性，那么我们就可以完成第一步的简写：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    constructor(props){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        <span style="color:#ff79c6">super</span>(props)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#6272a4">//this.state = {isHot:false,wind:&#39;微风&#39;}
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span>.changeWeather <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.changeWeather.bind(<span style="color:#ff79c6">this</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    <span style="color:#6272a4">//在这里追加属性state
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4"></span>    state <span style="color:#ff79c6">=</span> { isHot<span style="color:#ff79c6">:</span><span style="color:#ff79c6">false</span>, wind<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;微风&#39;</span> }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>        <span style="color:#ff79c6">const</span> {isHot,wind} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.changeWeather}&gt;今天天气很{isHot <span style="color:#ff79c6">?</span> <span style="color:#f1fa8c">&#39;炎热&#39;</span> <span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;凉爽&#39;</span>}，{wind}&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    changeWeather(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>        <span style="color:#ff79c6">const</span> isHot <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state.isHot
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>        <span style="color:#ff79c6">this</span>.setState({isHot<span style="color:#ff79c6">:!</span>isHot})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>接下来，完成对函数的简写，在上面我们可以知道，函数的定义和使用主要就是一个问题，<code>this</code>的指向问题，那么我们就可以使用追加属性的方式来解决这个问题。</p>
<p>当我们把原本的<code>changeWeather(){}</code>改写成<code>changeWeather = function{}</code>时，原本绑定在类的原型对象上的<code>changeWeather</code>函数，就变成追加在类的实例对象上的属性，而这个属性的值是一个函数。</p>
<p>但是这里又有一个问题是，<code>function{}</code>中的<code>this</code>也不是指向我们的类的实例对象的，而是指向调用时调用他的对象，而在这里，调用他的对象是onClick时的那个对象，而不是类的实例对象。</p>
<p>但如果使用箭头函数来表示时，变成<code>changeWeather = () =&gt; {}</code>，箭头函数的一大特点就是没有自己的<code>this</code>，而是指向上层对象，也就是类的实例对象。</p>
<p>这样我们就完美的解决了函数中<code>this</code>的指向问题。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#ff79c6">class</span> Weather <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    state <span style="color:#ff79c6">=</span> {isHot<span style="color:#ff79c6">:</span><span style="color:#ff79c6">false</span>,wind<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;微风&#39;</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#ff79c6">const</span> {isHot,wind} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        <span style="color:#ff79c6">return</span> &lt;<span style="color:#ff79c6">h1</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.changeWeather}&gt;今天天气很{isHot <span style="color:#ff79c6">?</span> <span style="color:#f1fa8c">&#39;炎热&#39;</span> <span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;凉爽&#39;</span>}，{wind}&lt;/<span style="color:#ff79c6">h1</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    <span style="color:#6272a4">//自定义方法————要用赋值语句的形式+箭头函数
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#6272a4"></span>    changeWeather <span style="color:#ff79c6">=</span> ()=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        <span style="color:#ff79c6">const</span> isHot <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.state.isHot
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>        <span style="color:#ff79c6">this</span>.setState({isHot<span style="color:#ff79c6">:!</span>isHot})
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>ReactDOM.render(&lt;<span style="color:#ff79c6">Weather</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><h3 id="5-props">5. props</h3>
<p><code>props</code>就是参数的意思，用于存储父组件传给子组件的变量。</p>
<p><code>state</code>是组件内部的值，<code>props</code>是组件外部传到组件内部的值。</p>
<h4 id="1-单个传递props">1. 单个传递props</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Person <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        <span style="color:#ff79c6">const</span> {name,age,sex} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.props
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#ff79c6">return</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>            &lt;<span style="color:#ff79c6">ul</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>                &lt;<span style="color:#ff79c6">li</span>&gt;姓名：{name}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>                &lt;<span style="color:#ff79c6">li</span>&gt;性别：{sex}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>                &lt;<span style="color:#ff79c6">li</span>&gt;年龄：{age<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>            &lt;/<span style="color:#ff79c6">ul</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        )
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">//渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Person</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;jerry&#34;</span> <span style="color:#50fa7b">age</span><span style="color:#ff79c6">=</span>{<span style="color:#bd93f9">19</span>}  <span style="color:#50fa7b">sex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;男&#34;</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test1&#39;</span>))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>ReactDOM.render(&lt;<span style="color:#ff79c6">Person</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;tom&#34;</span> <span style="color:#50fa7b">age</span><span style="color:#ff79c6">=</span>{<span style="color:#bd93f9">18</span>} <span style="color:#50fa7b">sex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;女&#34;</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test2&#39;</span>))
</code></pre></div><h4 id="2-批量传递props">2. 批量传递props</h4>
<p>如果一次传递特别多信息，一个一个的传，就很麻烦，这时候就需要批量的传递<code>props</code>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Person <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        <span style="color:#ff79c6">const</span> {name,age,sex} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.props
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#ff79c6">return</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>            &lt;<span style="color:#ff79c6">ul</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>                &lt;<span style="color:#ff79c6">li</span>&gt;姓名：{name}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>                &lt;<span style="color:#ff79c6">li</span>&gt;性别：{sex}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>                &lt;<span style="color:#ff79c6">li</span>&gt;年龄：{age<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>            &lt;/<span style="color:#ff79c6">ul</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        )
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#ff79c6">const</span> p <span style="color:#ff79c6">=</span> {name<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;老刘&#39;</span>,age<span style="color:#ff79c6">:</span><span style="color:#bd93f9">18</span>,sex<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;女&#39;</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>ReactDOM.render(&lt;<span style="color:#ff79c6">Person</span> {<span style="color:#50fa7b">...p</span>}/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test3&#39;</span>))
</code></pre></div><p>这里的<code>...p</code>用到了ES6的展开运算符：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">let</span> arr1 <span style="color:#ff79c6">=</span> [<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">3</span>,<span style="color:#bd93f9">5</span>,<span style="color:#bd93f9">7</span>,<span style="color:#bd93f9">9</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#8be9fd;font-style:italic">let</span> arr2 <span style="color:#ff79c6">=</span> [<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">4</span>,<span style="color:#bd93f9">6</span>,<span style="color:#bd93f9">8</span>,<span style="color:#bd93f9">10</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>console.log(...arr1); <span style="color:#6272a4">//展开一个数组
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">let</span> arr3 <span style="color:#ff79c6">=</span> [...arr1,...arr2]<span style="color:#6272a4">//连接数组
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4"></span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4">//在函数中使用 rest参数
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">function</span> sum(...numbers){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    <span style="color:#6272a4">//数组
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">return</span> numbers.reduce((preValue,currentValue)=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        <span style="color:#ff79c6">return</span> preValue <span style="color:#ff79c6">+</span> currentValue
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    })
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>console.log(sum(<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">3</span>,<span style="color:#bd93f9">4</span>));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4">//构造字面量对象时使用展开语法
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">let</span> person <span style="color:#ff79c6">=</span> {name<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;tom&#39;</span>,age<span style="color:#ff79c6">:</span><span style="color:#bd93f9">18</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">//深拷贝，但是只能深拷贝第一层
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">let</span> person2 <span style="color:#ff79c6">=</span> {...person}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4">//console.log(...person); //报错，展开运算符不能展开对象
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#6272a4"></span>person.name <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;jerry&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>console.log(person2);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>console.log(person);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#6272a4">//合并
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">let</span> person3 <span style="color:#ff79c6">=</span> {...person,name<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;jack&#39;</span>,address<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#34;地球&#34;</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>console.log(person3);
</code></pre></div><p>由此我们可以知道，js中展开运算符只能展开数组，而不能展开对象，只有在使用字面量赋值进行对象的克隆时才可以在<code>{}</code>使用<code>...</code>。</p>
<p>在<code>ReactDOM.render(&lt;Person {...p}/&gt;,document.getElementById('test3'))</code>这里的<code>{...}</code>并不是上面这种含义，在jsx中<code>{}</code>代表着内部是一段js代码，也就是说我们真的使用了<code>...</code>对一个对象进行展开了，这种操作在js中不允许，但是在jsx中可以允许，但是也只能使用在标签属性的传递。</p>
<h4 id="3-对props进行限制">3. 对props进行限制</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Person <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        <span style="color:#ff79c6">const</span> {name,age,sex} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.props
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#ff79c6">return</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>            &lt;<span style="color:#ff79c6">ul</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>                &lt;<span style="color:#ff79c6">li</span>&gt;姓名：{name}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>                &lt;<span style="color:#ff79c6">li</span>&gt;性别：{sex}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>                &lt;<span style="color:#ff79c6">li</span>&gt;年龄：{age<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>            &lt;/<span style="color:#ff79c6">ul</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        )
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4">//对标签属性进行类型、必要性的限制
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4"></span>Person.propTypes <span style="color:#ff79c6">=</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>    name<span style="color:#ff79c6">:</span>PropTypes.string.isRequired, <span style="color:#6272a4">//限制name必传，且为字符串
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4"></span>    sex<span style="color:#ff79c6">:</span>PropTypes.string,<span style="color:#6272a4">//限制sex为字符串
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4"></span>    age<span style="color:#ff79c6">:</span>PropTypes.number,<span style="color:#6272a4">//限制age为数值
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4"></span>    speak<span style="color:#ff79c6">:</span>PropTypes.func,<span style="color:#6272a4">//限制speak为函数
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#6272a4"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#6272a4">//指定默认标签属性值
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#6272a4"></span>Person.defaultProps <span style="color:#ff79c6">=</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>    sex<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;男&#39;</span>,<span style="color:#6272a4">//sex默认值为男
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span style="color:#6272a4"></span>    age<span style="color:#ff79c6">:</span><span style="color:#bd93f9">18</span> <span style="color:#6272a4">//age默认值为18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span style="color:#6272a4"></span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#6272a4">//渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Person</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span>{<span style="color:#bd93f9">100</span>} <span style="color:#50fa7b">speak</span><span style="color:#ff79c6">=</span>{speak}/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test1&#39;</span>))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>ReactDOM.render(&lt;<span style="color:#ff79c6">Person</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;tom&#34;</span> <span style="color:#50fa7b">age</span><span style="color:#ff79c6">=</span>{<span style="color:#bd93f9">18</span>} <span style="color:#50fa7b">sex</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;女&#34;</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test2&#39;</span>))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span style="color:#ff79c6">const</span> p <span style="color:#ff79c6">=</span> {name<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;老刘&#39;</span>,age<span style="color:#ff79c6">:</span><span style="color:#bd93f9">18</span>,sex<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;女&#39;</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>ReactDOM.render(&lt;<span style="color:#ff79c6">Person</span> {<span style="color:#50fa7b">...p</span>}/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test3&#39;</span>))
</code></pre></div><h4 id="4-props限制的简写">4. props限制的简写</h4>
<p>在上面的写法中，我们给Person这个类的原型对象添加了<code>propTypes</code>和<code>defaultProps</code>，既然是给类的原型对象添加属性，那么我们还可以使用<code>static</code>来进行属性的追加：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Person <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    constructor(props){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#6272a4">//构造器是否接收props，是否传递给super，取决于：是否希望在构造器中通过this访问props
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">// console.log(props);
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">super</span>(props)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        console.log(<span style="color:#f1fa8c">&#39;constructor&#39;</span>,<span style="color:#ff79c6">this</span>.props);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    <span style="color:#6272a4">//对标签属性进行类型、必要性的限制
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">static</span> propTypes <span style="color:#ff79c6">=</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>        name<span style="color:#ff79c6">:</span>PropTypes.string.isRequired, <span style="color:#6272a4">//限制name必传，且为字符串
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#6272a4"></span>        sex<span style="color:#ff79c6">:</span>PropTypes.string,<span style="color:#6272a4">//限制sex为字符串
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span style="color:#6272a4"></span>        age<span style="color:#ff79c6">:</span>PropTypes.number,<span style="color:#6272a4">//限制age为数值
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4"></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    <span style="color:#6272a4">//指定默认标签属性值
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">static</span> defaultProps <span style="color:#ff79c6">=</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>        sex<span style="color:#ff79c6">:</span><span style="color:#f1fa8c">&#39;男&#39;</span>,<span style="color:#6272a4">//sex默认值为男
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#6272a4"></span>        age<span style="color:#ff79c6">:</span><span style="color:#bd93f9">18</span> <span style="color:#6272a4">//age默认值为18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#6272a4"></span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>        <span style="color:#6272a4">// console.log(this);
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">const</span> {name,age,sex} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>.props
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>        <span style="color:#6272a4">//props是只读的
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span style="color:#6272a4"></span>        <span style="color:#6272a4">//this.props.name = &#39;jack&#39; //此行代码会报错，因为props是只读的
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>            &lt;<span style="color:#ff79c6">ul</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>                &lt;<span style="color:#ff79c6">li</span>&gt;姓名：{name}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>                &lt;<span style="color:#ff79c6">li</span>&gt;性别：{sex}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>                &lt;<span style="color:#ff79c6">li</span>&gt;年龄：{age<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>}&lt;/<span style="color:#ff79c6">li</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>            &lt;/<span style="color:#ff79c6">ul</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>        )
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span style="color:#6272a4">//渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Person</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;jerry&#34;</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test1&#39;</span>))
</code></pre></div><h3 id="6-类式组件的refs">6. 类式组件的refs</h3>
<p>组件内的标签，可以定义ref属性来标识自己，相当于原生的id。</p>
<h4 id="1-字符串形式ref">1. 字符串形式ref</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Demo <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    showData <span style="color:#ff79c6">=</span> ()=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>        console.log(<span style="color:#ff79c6">this</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        <span style="color:#ff79c6">return</span>(
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>            &lt;<span style="color:#ff79c6">div</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>                &lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">ref</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;input1&#34;</span> <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> <span style="color:#50fa7b">placeholder</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;点击按钮提示数据&#34;</span>/&gt;<span style="color:#ff79c6">&amp;</span>nbsp;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>                &lt;<span style="color:#ff79c6">button</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.showData}&gt;点我提示左侧的数据&lt;/<span style="color:#ff79c6">button</span>&gt;<span style="color:#ff79c6">&amp;</span>nbsp;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>                &lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">ref</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;input2&#34;</span> <span style="color:#50fa7b">onBlur</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.showData2} <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> <span style="color:#50fa7b">placeholder</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;失去焦点提示数据&#34;</span>/&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>            &lt;/<span style="color:#ff79c6">div</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>        )
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#6272a4">//渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Demo</span> <span style="color:#50fa7b">a</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;1&#34;</span> <span style="color:#50fa7b">b</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;2&#34;</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>这里我们输出组件的实例对象<code>this</code>，就会得到如图所示的结构：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20210328140129363.png" alt="image-20210328140129363"></p>
<p>在<code>refs</code>中以键值对的形式存放我们需要的信息，其中<code>key</code>是我们指定的<code>ref</code>名称，<code>value</code>是<code>ref</code>标记的真实dom标签，注意这里是真实dom而不是虚拟dom。</p>
<h4 id="2-回调函数形式的ref">2. 回调函数形式的ref</h4>
<p>字符串类型的<code>ref</code>已经不建议使用了，因为过多的字符串类型的<code>ref</code>会导致效率问题。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Demo <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>   showData <span style="color:#ff79c6">=</span> ()=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>       <span style="color:#ff79c6">const</span> {input1} <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>       alert(input1.value)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>   }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>   render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>       <span style="color:#ff79c6">return</span>(
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>           &lt;<span style="color:#ff79c6">div</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>               <span style="color:#6272a4">//这里使用回调函数的形式，将当前节点保存到了当前实例对象的input1属性上
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#6272a4"></span>               &lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">ref</span><span style="color:#ff79c6">=</span>{c =&gt; <span style="color:#ff79c6">this</span>.input1 <span style="color:#ff79c6">=</span> c } <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> <span style="color:#50fa7b">placeholder</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;点击按钮提示数据&#34;</span>/&gt;;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>               &lt;<span style="color:#ff79c6">button</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.showData}&gt;点我提示左侧的数据&lt;/<span style="color:#ff79c6">button</span>&gt;;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>           &lt;/<span style="color:#ff79c6">div</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>       )
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>   }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#6272a4">//渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Demo</span> /&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>回调函数形式的ref，回调函数的执行次数问题：</p>
<blockquote>
<p>如果 <code>ref</code> 回调函数是以内联函数的方式定义的，在更新过程中它会被执行两次，第一次传入参数 <code>null</code>，然后第二次会传入参数 DOM 元素。这是因为在每次渲染时会创建一个新的函数实例，所以 React 清空旧的 ref 并且设置新的。通过将 ref 的回调函数定义成 class 的绑定函数的方式可以避免上述问题，但是大多数情况下它是无关紧要的。</p>
</blockquote>
<p>这里的内联函数，指的就是我们上面定义的这种形式<code>ref={c =&gt; this.input1 = c }</code>。</p>
<p>那么为了解决这个问题，我们可以换成这样的写法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Demo <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    saveInput <span style="color:#ff79c6">=</span> (c)=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>        <span style="color:#ff79c6">this</span>.input1 <span style="color:#ff79c6">=</span> c;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>        console.log(<span style="color:#f1fa8c">&#39;@&#39;</span>,c);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        <span style="color:#ff79c6">return</span>(
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>            &lt;<span style="color:#ff79c6">div</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>                {<span style="color:#6272a4">/*&lt;input ref={(c)=&gt;{this.input1 = c;console.log(&#39;@&#39;,c);}} type=&#34;text&#34;/&gt;&lt;br/&gt;&lt;br/&gt;*/</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>                &lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">ref</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.saveInput} <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span>/&gt;&lt;<span style="color:#ff79c6">br</span>/&gt;&lt;<span style="color:#ff79c6">br</span>/&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>            &lt;/<span style="color:#ff79c6">div</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>        )
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span style="color:#6272a4">//渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Demo</span>/&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>但是开发中，我们肯定是写内联函数更加方便。</p>
<h4 id="3-createref">3. createRef</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#6272a4">//创建组件
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> Demo <span style="color:#ff79c6">extends</span> React.Component{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    <span style="color:#6272a4">//React.createRef调用后可以返回一个容器，该容器可以存储被ref所标识的节点,该容器是专人专用的
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#6272a4"></span>    myRef <span style="color:#ff79c6">=</span> React.createRef()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span> 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    showData <span style="color:#ff79c6">=</span> ()=&gt;{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        alert(<span style="color:#ff79c6">this</span>.myRef.current.value);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    render(){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>        <span style="color:#ff79c6">return</span>(
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>            &lt;<span style="color:#ff79c6">div</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>                &lt;<span style="color:#ff79c6">input</span> <span style="color:#50fa7b">ref</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.myRef} <span style="color:#50fa7b">type</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;text&#34;</span> <span style="color:#50fa7b">placeholder</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;点击按钮提示数据&#34;</span>/&gt;<span style="color:#ff79c6">&amp;</span>nbsp;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>                &lt;<span style="color:#ff79c6">button</span> <span style="color:#50fa7b">onClick</span><span style="color:#ff79c6">=</span>{<span style="color:#ff79c6">this</span>.showData}&gt;点我提示左侧的数据&lt;/<span style="color:#ff79c6">button</span>&gt;<span style="color:#ff79c6">&amp;</span>nbsp;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>            &lt;/<span style="color:#ff79c6">div</span>&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>        )
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span style="color:#6272a4">//渲染组件到页面
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span style="color:#6272a4"></span>ReactDOM.render(&lt;<span style="color:#ff79c6">Demo</span> /&gt;,<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;test&#39;</span>))
</code></pre></div><p>本文是 深入react 的第1篇文章，下一篇是《react 生命周期详解》。</p>

      </div>
      <div class="footer">
        <span><a class="category" href="https://tomtomyoung.top/categories/%E5%89%8D%E7%AB%AF/">前端</a></span>
        <span><a class="tag" href="https://tomtomyoung.top/tags/react/">react</a></span>
      </div>

      
    </div><ul class="menu">
    <li class="menu-item">
        <i class="iconfont icon-top item-btn" id="back_top_btn"></i>
    </li>
    <li class="menu-item">
        <a href="https://tomtomyoung.top/" id="back-btn">
            <i class="iconfont icon-home item-btn"></i>
        </a>
    </li>
    <li class="menu-item">
        <i class="iconfont icon-switch item-btn" id="switch_btn"></i>
    </li>
    <li class="menu-item">
        <i class="iconfont icon-search item-btn" id="search_btn"></i>
    </li>
    <li class="menu-item">
        
        <a class="" href="https://tomtomyoung.top/post/js-%E6%89%8B%E5%86%99promise/" data-tooltip="js 手写Promise">
            <i class="iconfont icon-left item-btn"></i>
            
        </a>
    </li>
    <li class="menu-item">
        
        <a class="" href="https://tomtomyoung.top/post/js-%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/" data-tooltip="js 箭头函数详解">
            <i class="iconfont icon-right item-btn"></i>
            
        </a>
    </li>
</ul></div>
</div>

<div class="cover" id="cover">
        <div class="search-container">
    <input type="search" class="docsearch-input search-input" placeholder="搜索关键词" />
    
</div>
    </div>
</body>








<script type="text/javascript" src="https://tomtomyoung.top/js/util.min.js" integrity=""></script></html>