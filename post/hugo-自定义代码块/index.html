<!DOCTYPE html>
<html lang="zh-cn" data-theme="light"><head>
    <meta name="google-site-verification" content="kw1N-Xm6qEr1c9PGuRd0U_T6DXkw_EHsLyz5LpuDDv8" />
    <meta name="msvalidate.01" content="EE98205D30806C22C519683EFC53E9BA" />
    <meta name="baidu-site-verification" content="iPC3wUcQLL" />
    <title>  hugo 自定义代码块 </title>
    <meta charset="utf-8" /><meta name="generator" content="Hugo 0.85.0" /><meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1" />
    <meta name="description" itemprop="description"
        content=" hugo 自定义代码块 " />
    <meta name="keywords" itemprop="keywords"
        content=" [hugo 代码块] " />
    <base href="https://tomtomyoung.top/">
    <link rel="shortcut icon" href="https://tomtomyoung.top/favicons//favicon.ico" type="image/x-icon">
    <link rel="icon" type="image/png" sizes="32x32" href="https://tomtomyoung.top/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://tomtomyoung.top/favicons/favicon-16x16.png">
    <link rel="canonical" href="https://tomtomyoung.top/post/hugo-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%A3%E7%A0%81%E5%9D%97/">
    <link rel="stylesheet" type="text/css" href="https://at.alicdn.com/t/font_2450869_iypnqhtzjei.css">
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="https://tomtomyoung.top/css/style.min.efda7717cbf0ab8dc9081c89b5e1a58e3c7b9b8ee3471c759bea8a750722a7ab.css" integrity="" type="text/css">
</head><body>
<div class="main animated fadeInDown">
  <div class="toc sub-container">
    <div class="toc-header">
        <span>目录</span>
        <span id="read-percentage"></span>
    </div>
    <ul class="toc-h3"><li>
                    <a href="https://tomtomyoung.top/post/hugo-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%A3%E7%A0%81%E5%9D%97/#1-%e8%87%aa%e5%ae%9a%e4%b9%89%e4%bb%a3%e7%a0%81%e5%9d%97%e6%a0%b7%e5%bc%8f" class="toc-link">1. 自定义代码块样式</a>
                </li>
                <li>
                    <a href="https://tomtomyoung.top/post/hugo-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%A3%E7%A0%81%E5%9D%97/#2-%e6%b7%bb%e5%8a%a0cope%e6%8c%89%e9%92%ae" class="toc-link">2. 添加Cope按钮</a>
                </li>
                <li>
                    <a href="https://tomtomyoung.top/post/hugo-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%A3%E7%A0%81%E5%9D%97/#3-%e7%bb%99cope%e6%8c%89%e9%92%ae%e6%b7%bb%e5%8a%a0%e5%8a%9f%e8%83%bd" class="toc-link">3. 给Cope按钮添加功能</a>
                </li>
                </div><div class="single-post container">
    <div class="post">
      <div class="header">
        <span class="title">hugo 自定义代码块</span>
        
        <div class="info">
          <span>📅 2020-12-31</span>
          <span>👦 Tomtom Young</span>
          <span>📖 1708字</span>
          <span>⏱ 4分钟</span>
        </div>
        
      </div>
      <div class="content markdown-body">
        <h3 id="1-自定义代码块样式">1. 自定义代码块样式</h3>
<p>根据hugo的官方文档，我们可以看到hugo可以配置使用多种markdown的解析器，<a href="https://gohugo.io/getting-started/configuration-markup/">hugo markup 配置</a></p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20201231200000209.png" alt="image-20201231200000209"></p>
<p>其中有一项是highlight的配置：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20201231200128436.png" alt="image-20201231200128436"></p>
<p>将官方文档的配置项，放进自己的配置文件中，这里一定要注意你自己的配置文件的格式！一般来说，hogo的配置文件都在根目录下，文件名为<code>config.toml</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>[markup]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>  [markup.highlight]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    anchorLineNos = <span style="color:#ff79c6">false</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    codeFences = <span style="color:#ff79c6">true</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    guessSyntax = <span style="color:#ff79c6">true</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    hl_Lines = <span style="color:#f1fa8c">&#34;&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    lineAnchors = <span style="color:#f1fa8c">&#34;&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    lineNoStart = <span style="color:#bd93f9">1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    lineNos = <span style="color:#ff79c6">true</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    lineNumbersInTable = <span style="color:#ff79c6">true</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    noClasses = <span style="color:#ff79c6">true</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    style = <span style="color:#f1fa8c">&#34;dracula&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    tabWidth = <span style="color:#bd93f9">4</span>
</code></pre></div><p>其中的<code>style</code>配置项是关于代码块样式的，样式非常多，可以去github上自己看一下，选一个自己喜欢的，<a href="https://xyproto.github.io/splash/docs/longer/all.html">highlight主题</a></p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20201231200423680.png" alt="image-20201231200423680"></p>
<p>如果渲染的样式你自己并不满意，还可以自己编辑css，来进一步自定义，比如我又添加了如下的配置：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-css" data-lang="css"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>.<span style="color:#50fa7b">highlight</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  <span style="color:#ff79c6">position</span>: <span style="color:#ff79c6">relative</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>  <span style="color:#ff79c6">display</span>: <span style="color:#ff79c6">block</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>  <span style="color:#ff79c6">overflow-x</span>: <span style="color:#ff79c6">auto</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>  <span style="color:#ff79c6">font-family</span>: Consolas,Monaco,Menlo,Consolas,<span style="color:#ff79c6">monospace</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>  <span style="color:#ff79c6">line-height</span>: <span style="color:#bd93f9">1.5</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>}
</code></pre></div><p>这里要注意的是，这个css文件一定要引入你的模板中，你可以采用两种方式：一种是找到一个已经引入的css文件，在里面添加你的代码；另一种是新建一个css文件，写好代码之后引入模板。</p>
<p><strong>第一种方式</strong></p>
<p>我使用的模板的结构如下图所示，我把自定义的css样式放进了<code>assets/css/stule.css</code>中：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20201231205847336.png" alt="image-20201231205847336"></p>
<p>同时，在<code>partials/header.html</code>中，已经导入了<code>style.css</code>，因此可以确保我的css样式可以生效：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20201231210036449.png" alt="image-20201231210036449"></p>
<p><strong>第二种方式</strong></p>
<p>我可以在css文件夹下新建一个<code>highlight.css</code>文件，将我的css样式写入，同时，一定要在<code>head.html</code>中引入这个css文件：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>{{ $style := resources.Get &#34;css/highlight.css&#34; | resources.Minify | resources.Fingerprint }}
</code></pre></div><p>还要注意的是<code>position: relative;</code>是一定要写的，这个属性用来定位cope按钮。经过一番操作，现在我的代码块变成了这样：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20201231200746256.png" alt="image-20201231200746256"></p>
<h3 id="2-添加cope按钮">2. 添加Cope按钮</h3>
<p>手动复制代码很麻烦，还会带有行号，这里我们给每个代码块添加一个Cope按钮。首先定义按钮的样式：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-css" data-lang="css"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>.<span style="color:#50fa7b">highlight-copy-btn</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>  <span style="color:#ff79c6">position</span>: <span style="color:#ff79c6">absolute</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>  <span style="color:#ff79c6">top</span>: <span style="color:#bd93f9">7</span><span style="color:#8be9fd">px</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>  <span style="color:#ff79c6">right</span>: <span style="color:#bd93f9">7</span><span style="color:#8be9fd">px</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>  <span style="color:#ff79c6">border</span>: <span style="color:#bd93f9">0</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>  <span style="color:#ff79c6">border-radius</span>: <span style="color:#bd93f9">4</span><span style="color:#8be9fd">px</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>  <span style="color:#ff79c6">padding</span>: <span style="color:#bd93f9">1</span><span style="color:#8be9fd">px</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>  <span style="color:#ff79c6">font-size</span>: <span style="color:#bd93f9">0.8</span><span style="color:#8be9fd">em</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>  <span style="color:#ff79c6">line-height</span>: <span style="color:#bd93f9">1.8</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>  <span style="color:#ff79c6">color</span>: <span style="color:#bd93f9">#fff</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>  <span style="color:#ff79c6">background-color</span>: <span style="color:#bd93f9">#777</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>  <span style="color:#ff79c6">min-width</span>: <span style="color:#bd93f9">55</span><span style="color:#8be9fd">px</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>  <span style="color:#ff79c6">text-align</span>: <span style="color:#ff79c6">center</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>.<span style="color:#50fa7b">highlight-copy-btn</span>:hover {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>  <span style="color:#ff79c6">background-color</span>: <span style="color:#bd93f9">#666</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>}
</code></pre></div><p>然后我们将按钮添加到每个代码块中，注意这里一定要保证<code>.highlight</code>添加了<code>position: relative;</code>属性，否则按钮的定位会出现问题。</p>
<p>我们在js文件中写一个新的函数，或者新写一个js文件（这里和刚才我们介绍的css写法一样，我们既可以在<code>js</code>文件夹下的某一个已经导入的js文件中添加我们的函数，也可以在<code>js</code>文件夹下新建一个文件来写我们的函数，总之要保证这个js文件最终引入了我们的模板中，引入的代码一般是：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>{{ $anatole <span style="color:#ff79c6">:=</span> resources.Get <span style="color:#f1fa8c">&#34;js/global.js&#34;</span> }}
</code></pre></div><p>我们在自己选择的文件里面写一个新函数<code>addCopyButton</code>，并对于每一个代码块都执行这个函数，给每个代码块都添加上Cope按钮：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">function</span> addCopyButton(containerEl) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    <span style="color:#8be9fd;font-style:italic">var</span> copyBtn <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">document</span>.createElement(<span style="color:#f1fa8c">&#34;button&#34;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    copyBtn.className <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;highlight-copy-btn&#34;</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    copyBtn.textContent <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Copy&#34;</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    containerEl.appendChild(copyBtn);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#8be9fd;font-style:italic">var</span> highlightBlocks <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">document</span>.getElementsByClassName(<span style="color:#f1fa8c">&#39;highlight&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#ff79c6">if</span>(highlightBlocks<span style="color:#ff79c6">!=</span><span style="color:#ff79c6">null</span>){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    <span style="color:#8be9fd;font-style:italic">Array</span>.prototype.forEach.call(highlightBlocks, addCopyButton);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>}
</code></pre></div><p>这样我们就给每个代码块添加了一个类名为<code>highlight-copy-btn</code>的Cope按钮，现在我们的代码块长这样：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20201231201506402.png" alt="image-20201231201506402"></p>
<h3 id="3-给cope按钮添加功能">3. 给Cope按钮添加功能</h3>
<p>现在这个Cope按钮是没有任何功能的，我们还需要给这个按钮绑定一个点击事件。</p>
<p>我们要复制一段信息时，先要选择这段信息，然后复制到剪切板，也就是说我们要定义两个函数，一个是选择文字，一个是复制到剪切板，同样我们将函数写在刚才的<code>addCopyButton</code>旁边，我们先写选择文字函数<code>selectText</code>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">function</span> selectText(node) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    <span style="color:#8be9fd;font-style:italic">var</span> selection <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">window</span>.getSelection();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    <span style="color:#8be9fd;font-style:italic">var</span> range <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">document</span>.createRange();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    range.selectNodeContents(node);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>    selection.removeAllRanges();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>    selection.addRange(range);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>    <span style="color:#ff79c6">return</span> selection;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span>}
</code></pre></div><p>再写复制到剪切板函数<code>flashCopyMessage</code>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#8be9fd;font-style:italic">function</span> flashCopyMessage(el, msg) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    el.textContent <span style="color:#ff79c6">=</span> msg;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    setTimeout(<span style="color:#8be9fd;font-style:italic">function</span>() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>      el.textContent <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Copy&#34;</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>    }, <span style="color:#bd93f9">1000</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>}
</code></pre></div><p>最后我们给Cope按钮绑定这两个函数：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#8be9fd;font-style:italic">function</span> addCopyButton(containerEl) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    <span style="color:#8be9fd;font-style:italic">var</span> copyBtn <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">document</span>.createElement(<span style="color:#f1fa8c">&#34;button&#34;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    copyBtn.className <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;highlight-copy-btn&#34;</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    copyBtn.textContent <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;Copy&#34;</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#8be9fd;font-style:italic">var</span> codeEl <span style="color:#ff79c6">=</span> containerEl.firstElementChild.firstElementChild.firstElementChild.firstElementChild.children[<span style="color:#bd93f9">1</span>];
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    copyBtn.addEventListener(<span style="color:#f1fa8c">&#39;click&#39;</span>, <span style="color:#8be9fd;font-style:italic">function</span>() {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>      <span style="color:#ff79c6">try</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>        <span style="color:#8be9fd;font-style:italic">var</span> selection <span style="color:#ff79c6">=</span> selectText(codeEl);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        <span style="color:#8be9fd;font-style:italic">document</span>.execCommand(<span style="color:#f1fa8c">&#39;copy&#39;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>        selection.removeAllRanges();
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>        flashCopyMessage(copyBtn, <span style="color:#f1fa8c">&#39;Copied!&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>      } <span style="color:#ff79c6">catch</span>(e) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>        console <span style="color:#ff79c6">&amp;&amp;</span> console.log(e);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>        flashCopyMessage(copyBtn, <span style="color:#f1fa8c">&#39;Failed :\&#39;(&#39;</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>      }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    });
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    containerEl.appendChild(copyBtn);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>}
</code></pre></div><p>这里要注意的是<code>codeEl</code>的选择一定要根据你的实际情况，先要避免选择行号的话，最好在配置文件中，配置<code>lineNumbersInTable = true</code>，这样会把你的代码块渲染成一个Table，方便去选择不包含行号的部分，比如我的代码内容是这个结构：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20201231202357500.png" alt="image-20201231202357500"></p>
<p>那么我就要从<code>.highlight</code>出发，往下找4层，然后选择第二个子节点，就可以选择到我的代码内容了，不同的结构要进行适当调整。</p>
<p>经过一番折腾，现在Cope按钮就有了复制的功能，点击Cope按钮，复制成功会显示Copied!信息，失败会显示Failed信息：</p>
<p><img src="https://blogimg-1302307650.cos.ap-shanghai.myqcloud.com/image-20201231202834857.png" alt="image-20201231202834857"></p>

      </div>
      <div class="footer">
        <span><a class="category" href="https://tomtomyoung.top/%20categories/%E5%8D%9A%E5%AE%A2/">博客</a></span>
        <span><a class="tag" href="https://tomtomyoung.top/%20tags/hugo/">hugo</a></span>
        
      </div>
    </div>

    <ul class="menu">
    <li class="menu-item">
        <a href="https://tomtomyoung.top/" id="back-btn">
            <i class="iconfont icon-home item-btn"></i>
        </a>
    </li>
    <li class="menu-item">
        <a href="javascript:void(0);" id="back-top-btn">
            <i class="iconfont icon-top item-btn"></i>
        </a>
    </li>
    <li class="menu-item">
        <a href="javascript:void(0);" id="switch-btn">
            <i class="iconfont icon-switch item-btn"></i>
        </a>
    </li>
    <li class="menu-item">
        <a href="javascript:void(0);" id="search-btn">
            <i class="iconfont icon-search item-btn"></i>
        </a>
    </li>
    <li class="menu-item">
        
        <a class="" href="https://tomtomyoung.top/post/%E8%BD%AC%E8%BD%BD%E6%9C%BA%E5%99%A8%E4%B8%8E%E4%BA%BA%E7%B1%BB%E8%A7%86%E8%A7%89%E8%83%BD%E5%8A%9B%E7%9A%84%E5%B7%AE%E8%B7%9D2/" data-tooltip="(转载)机器与人类视觉能力的差距（2）">
            <i class="iconfont icon-left item-btn"></i>
            
        </a>
    </li>
    <li class="menu-item">
        
        <a class="" href="https://tomtomyoung.top/post/%E4%BA%92%E8%81%94%E7%BD%91%E5%BB%BA%E7%AB%99%E5%85%A8%E6%B5%81%E7%A8%8B/" data-tooltip="互联网建站全流程">
            <i class="iconfont icon-right item-btn"></i>
            
        </a>
    </li>
</ul>

  </div>
</div>

<div class="cover animated fadeInShow">
        <div class="search-container animated fadeInShow">
    <input type="search" class="docsearch-input search-input" placeholder="搜索关键词" />
    <div id="loading" class="loading-container">
        <span>搜索中...</span>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript">
    docsearch({
        apiKey: 'f7f9aeb8485880cfd0e747129ea4ddf9',
        indexName: 'blogsearch',
        appId: 'SGIZDO9IMB',
        inputSelector: '.docsearch-input',
        debug: true,
        algoliaOptions: {
            hitsPerPage: 50
        },
        
        
        
        queryHook: (query) => {
            $('#loading').css('display', 'flex');
        },
        transformData: (tips) => {
            $('#loading').css('display', 'none');
        }
    })
</script>
    </div>
</body>



<script type="text/javascript" src="https://tomtomyoung.top/js/util.min.801ba58b9554e77a2688843e942518db9f3bba50276845cc90afcd9fe5f4deac2c0fa3d1d918ec41dd1aea45a16b7782e09a365fe34d756db8d3bcacb3ccd3f4.js" integrity=""></script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-168042857-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</html>