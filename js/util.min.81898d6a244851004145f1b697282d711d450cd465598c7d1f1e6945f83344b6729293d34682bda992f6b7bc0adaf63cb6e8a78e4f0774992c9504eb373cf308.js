function throttle(fn,wait){var timer=null;return function(){var context=this;var args=arguments;if(!timer){timer=setTimeout(function(){fn.apply(context,args);timer=null;},wait)}}};(function(){function getTheme(){return localStorage.getItem('theme')?localStorage.getItem('theme'):null;}
function setTheme(style){document.documentElement.setAttribute('data-theme',style);localStorage.setItem('theme',style);}
function switchTheme(e){var theme=getTheme();setTheme((theme=='light')?'dark':'light');}
(function(){var theme=getTheme();const userPrefersDark=window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches;if(theme===null){setTheme(userPrefersDark?'dark':'light');}
else{document.documentElement.setAttribute('data-theme',(theme=='light')?'light':'dark');}})()
var switchBtn=null;window.addEventListener('DOMContentLoaded',e=>{switchBtn=document.querySelectorAll('#switch_btn');!!switchBtn&&switchBtn.forEach(ele=>{ele.addEventListener('click',switchTheme);})},{once:true})})();;(function(){function changeSearchShow(e){if(!!searchContainer&&!!cover&&!!searchBtn&&(e.target==cover||e.target==searchBtn)){searchContainer.classList.toggle('show');cover.classList.toggle('show');e.stopPropagation();}}
var searchContainer=null;var cover=null;var searchBtn=null;window.addEventListener('DOMContentLoaded',e=>{searchContainer=document.querySelector('.search-container');searchBtn=document.querySelector('#search_btn');cover=document.querySelector('#cover');!!searchBtn&&searchBtn.addEventListener('click',changeSearchShow);!!cover&&cover.addEventListener('click',changeSearchShow);},{once:true})})();;(function(){function scrollTo(targetHeight){if(!!singlePost&&!!header&&!!content&&!!footer){let totalHeight=content.offsetHeight+footer.offsetHeight+header.offsetHeight+160-document.body.clientHeight;if(targetHeight>totalHeight){targetHeight=totalHeight;}
let currentHeight=singlePost.scrollTop;let needScrollTop=targetHeight-currentHeight;setTimeout(()=>{let dist=Math.ceil(needScrollTop/10);currentHeight+=dist
singlePost.scrollTop=currentHeight;if((needScrollTop>10||needScrollTop<-10)){scrollTo(targetHeight)}else{singlePost.scrollTop=targetHeight;}},20)}}
function backToTop(){if(!!singlePost){scrollTo(0);}}
function setReadPercentage(){if(!!singlePost&&!!header&&!!content&&!!footer&&!!percentage){let currentHeight=singlePost.scrollTop;let totalHeight=content.offsetHeight+footer.offsetHeight+header.offsetHeight+160-document.body.clientHeight;let readPercentage=Math.round((currentHeight/totalHeight)*100);percentage.style.width=`${readPercentage}%`;}}
function showMenu(currentHeight){if(!!menu){currentHeight>50?menu.classList.add('show'):menu.classList.remove('show');}}
function checkCurrentHeader(currentHeight){if(!!currentHeight&&!!headerList&&!!tocList&&headerList.length>0&&tocList.length>0&&headerList?.length==tocList?.length){let activeIndex=null;for(let index=0;index<=headerList.length;index++){if(!!headerList[index]&&!!headerList[index+1]){if(!!headerList[index]?.offsetTop&&currentHeight>headerList[index].offsetTop&&!!headerList[index+1]?.offsetTop&&currentHeight<headerList[index+1].offsetTop){activeIndex=index;break;}}
if(!!headerList[index]&&!headerList[index+1]){if(!!headerList[index]?.offsetTop&&currentHeight>headerList[index].offsetTop){activeIndex=index;break;}}}
clearActivedTocItem();!!tocList[activeIndex]&&tocList[activeIndex].classList.add('active');}}
function clearActivedTocItem(){let activeTocEle=document.querySelectorAll('.toc li .active');!!activeTocEle&&activeTocEle.forEach(ele=>ele.classList.remove('active'));}
function handleImgError(e){e.target.src='/images/img_error.svg';}
var singlePost=null;var header=null;var content=null;var footer=null;var headerList=null;var tocList=null;var imgList=null;var menu=null;var backTopBtn=null;var percentage=null;window.addEventListener('DOMContentLoaded',e=>{singlePost=document.querySelector('.single-post');header=document.querySelector('.single-post .post .header');content=document.querySelector('.single-post .post .content');footer=document.querySelector('.single-post .post .footer');headerList=document.querySelectorAll('.content h1[id],h2[id],h3[id],h4[id],h5[id]');tocList=document.querySelectorAll('.toc li .toc-link');imgList=document.querySelectorAll('.content img');menu=document.querySelector('.menu');backTopBtn=document.querySelector('#back_top_btn');percentage=document.querySelector('#percentage');if(!!imgList&&imgList.length>0){imgList.forEach(ele=>{ele.onerror=handleImgError;})}
if(!!singlePost){checkCurrentHeader(singlePost.scrollTop+document.body.clientHeight);singlePost.addEventListener('scroll',throttle(()=>{checkCurrentHeader(singlePost.scrollTop+document.body.clientHeight);showMenu(singlePost.scrollTop);setReadPercentage();},200))};if(!!tocList&&tocList.length>0&&!!headerList&&headerList.length>0){tocList.forEach((ele,index)=>{ele.addEventListener('click',e=>{if(!!headerList[index]){scrollTo(headerList[index].offsetTop);}})})}
!!backTopBtn&&backTopBtn.addEventListener('click',backToTop);!!percentage&&setReadPercentage();},{once:true});window.addEventListener('resize',throttle(()=>{if(!!singlePost){checkCurrentHeader(singlePost.scrollTop+document.body.clientHeight);setReadPercentage();}},200))})();